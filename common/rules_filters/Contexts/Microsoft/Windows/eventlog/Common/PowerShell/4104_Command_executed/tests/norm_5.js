{
    "action": "execute",
    "category.generic": "Command",
    "category.high": "System Management",
    "category.low": "Manipulation",
    "event_src.category": "Operating system",
    "event_src.hostname": "win1",
    "event_src.subsys": "Microsoft-Windows-PowerShell/Operational",
    "event_src.title": "windows",
    "event_src.vendor": "microsoft",
    "id": "PT_Microsoft_Windows_eventlog_Common_PowerShell_4104_Command_executed",
    "importance": "info",
    "msgid": "4104",
    "numfield1": 1,
    "numfield2": 1,
    "object": "command",
    "object.account.id": "S-1-5-21-506420898-248497907-2261400522-1000",
    "object.fullpath": "C:\\WINDOWS\\TEMP\\SDIAG_30d67e29-b404-4326-9ad5-bfa4cb519a60\\TS_WERQueue.ps1",
    "object.id": "9ff13488-8576-4dbb-85c0-88aed29a6c03",
    "object.name": "TS_WERQueue.ps1",
    "object.path": "C:\\WINDOWS\\TEMP\\SDIAG_30d67e29-b404-4326-9ad5-bfa4cb519a60\\",
    "object.process.cmdline": "# Copyright Â© 2008, Microsoft Corporation. All rights reserved.trap {break}# Include common library. .\\CL_Utility.ps1Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData# Troubleshooting WER queueWrite-DiagProgress -Activity $localizationString.CheckWERQueue[double]$freeSpace = Get-FreeSpace[double]$percentage = Get-Percentage[string]$userReportPath = Get-UserReportPath[string]$machineReportPath = Get-MachineReportPath[double]$userReportSize = Get-FolderSize $userReportPath[double]$machineReportSize = Get-FolderSize $machineReportPath[double]$totalSize = Format-DiskSpaceMB ($userReportSize + $machineReportSize)# Reporting$systemDrive = Get-SystemDriveInfoif($systemDrive -ne $null) {    $systemDrive | Select-Object -Property @{Name=$localizationString.driveName;Expression={$_.DeviceID}},@{Name=$localizationString.FreeSpace;Expression={(Format-DiskSpaceGB $_.FreeSpace) + \"GB\"}},@{Name=$localizationString.totalSpace;Expression={(Format-DiskSpaceGB $_.Size) + \"GB\"}} | ConvertTo-Xml | Update-DiagReport -id SystemDriveInfo -Name $localizationString.systemDriveInfo_name -Description $localizationString.systemDriveInfo_description -rid \"RC_WERQueue\"}@{Name=$userReportPath;Space=$userReportSize} | Select-Object -Property @{Name=$localizationString.userReportPath;Expression={$_.Name}},@{Name=$localizationString.userReportSpace;Expression={(Format-DiskSpaceMB $_.Space) + \"MB\"}} | ConvertTo-Xml | Update-DiagReport -id UserReprotInfo -Name $localizationString.UserReportInfo_name -Description $localizationString.UserReportInfo_description -rid \"RC_WERQueue\"@{Name=$machineReportPath;Space=$machineReportSize} | Select-Object -Property @{Name=$localizationString.MachineReportPath;Expression={$_.Name}},@{Name=$localizationString.MachineReportSpace;Expression={(Format-DiskSpaceMB $_.Space) + \"MB\"}} | ConvertTo-Xml | Update-DiagReport -id AdminReprotInfo -Name $localizationString.MachineReportInfo_name -Description $localizationString.MachineReportInfo_description -rid \"RC_WERQueue\"if((($freeSpace + $userReportSize) -gt 0) -and ($percentage -ge 0)) {    if(($userReportSize / ($freeSpace + $userReportSize)) * 100 -gt $percentage) {        Update-Diagrootcause -ID \"RC_WERQueue\" -Detected $true -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}        return    }}if((($freeSpace + $machineReportSize) -gt 0) -and ($percentage -ge 0)) {    if(($machineReportSize / ($freeSpace + $machineReportSize) * 100 -gt $percentage)) {        Update-DiagRootcause -ID \"RC_WERQueue\" -Detected $true -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}        return    }}Update-DiagRootcause -ID \"RC_WERQueue\" -Detected $false -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}",
    "object.process.id": "6400",
    "object.value": "# Copyright Â© 2008, Microsoft Corporation. All rights reserved.trap {break}# Include common library. .\\CL_Utility.ps1Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData# Troubleshooting WER queueWrite-DiagProgress -Activity $localizationString.CheckWERQueue[double]$freeSpace = Get-FreeSpace[double]$percentage = Get-Percentage[string]$userReportPath = Get-UserReportPath[string]$machineReportPath = Get-MachineReportPath[double]$userReportSize = Get-FolderSize $userReportPath[double]$machineReportSize = Get-FolderSize $machineReportPath[double]$totalSize = Format-DiskSpaceMB ($userReportSize + $machineReportSize)# Reporting$systemDrive = Get-SystemDriveInfoif($systemDrive -ne $null) {    $systemDrive | Select-Object -Property @{Name=$localizationString.driveName;Expression={$_.DeviceID}},@{Name=$localizationString.FreeSpace;Expression={(Format-DiskSpaceGB $_.FreeSpace) + \"GB\"}},@{Name=$localizationString.totalSpace;Expression={(Format-DiskSpaceGB $_.Size) + \"GB\"}} | ConvertTo-Xml | Update-DiagReport -id SystemDriveInfo -Name $localizationString.systemDriveInfo_name -Description $localizationString.systemDriveInfo_description -rid \"RC_WERQueue\"}@{Name=$userReportPath;Space=$userReportSize} | Select-Object -Property @{Name=$localizationString.userReportPath;Expression={$_.Name}},@{Name=$localizationString.userReportSpace;Expression={(Format-DiskSpaceMB $_.Space) + \"MB\"}} | ConvertTo-Xml | Update-DiagReport -id UserReprotInfo -Name $localizationString.UserReportInfo_name -Description $localizationString.UserReportInfo_description -rid \"RC_WERQueue\"@{Name=$machineReportPath;Space=$machineReportSize} | Select-Object -Property @{Name=$localizationString.MachineReportPath;Expression={$_.Name}},@{Name=$localizationString.MachineReportSpace;Expression={(Format-DiskSpaceMB $_.Space) + \"MB\"}} | ConvertTo-Xml | Update-DiagReport -id AdminReprotInfo -Name $localizationString.MachineReportInfo_name -Description $localizationString.MachineReportInfo_description -rid \"RC_WERQueue\"if((($freeSpace + $userReportSize) -gt 0) -and ($percentage -ge 0)) {    if(($userReportSize / ($freeSpace + $userReportSize)) * 100 -gt $percentage) {        Update-Diagrootcause -ID \"RC_WERQueue\" -Detected $true -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}        return    }}if((($freeSpace + $machineReportSize) -gt 0) -and ($percentage -ge 0)) {    if(($machineReportSize / ($freeSpace + $machineReportSize) * 100 -gt $percentage)) {        Update-DiagRootcause -ID \"RC_WERQueue\" -Detected $true -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}        return    }}Update-DiagRootcause -ID \"RC_WERQueue\" -Detected $false -Parameter @{'UnwantedSpace'=(Format-DiskSpaceMB $totalSize)}",
    "status": "success",
    "subject": "account",
    "subject.account.id": "S-1-5-21-506420898-248497907-2261400522-1000",
    "time": "2019-07-03T10:41:10.900Z"
}
