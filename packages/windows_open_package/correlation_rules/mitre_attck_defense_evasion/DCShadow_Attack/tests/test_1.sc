{"action": "modify", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4742\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13825\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-05-08T03:00:37.5861731Z\"},\"EventRecordID\":\"203057\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"444\",\"ThreadID\":\"1224\"},\"Channel\":\"Security\",\"Computer\":\"DC1.insecurebank.local\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"ComputerAccountChange\",\"text\":\"-\"},{\"Name\":\"TargetUserName\",\"text\":\"ALICE$\"},{\"Name\":\"TargetDomainName\",\"text\":\"insecurebank\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-21-738609754-2819869699-4189121830-1120\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-738609754-2819869699-4189121830-500\"},{\"Name\":\"SubjectUserName\",\"text\":\"Administrator\"},{\"Name\":\"SubjectDomainName\",\"text\":\"insecurebank\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x418a6fb\"},{\"Name\":\"PrivilegeList\",\"text\":\"-\"},{\"Name\":\"SamAccountName\",\"text\":\"-\"},{\"Name\":\"DisplayName\",\"text\":\"-\"},{\"Name\":\"UserPrincipalName\",\"text\":\"-\"},{\"Name\":\"HomeDirectory\",\"text\":\"-\"},{\"Name\":\"HomePath\",\"text\":\"-\"},{\"Name\":\"ScriptPath\",\"text\":\"-\"},{\"Name\":\"ProfilePath\",\"text\":\"-\"},{\"Name\":\"UserWorkstations\",\"text\":\"-\"},{\"Name\":\"PasswordLastSet\",\"text\":\"-\"},{\"Name\":\"AccountExpires\",\"text\":\"-\"},{\"Name\":\"PrimaryGroupId\",\"text\":\"-\"},{\"Name\":\"AllowedToDelegateTo\",\"text\":\"-\"},{\"Name\":\"OldUacValue\",\"text\":\"-\"},{\"Name\":\"NewUacValue\",\"text\":\"-\"},{\"Name\":\"UserAccountControl\",\"text\":\"-\"},{\"Name\":\"UserParameters\",\"text\":\"-\"},{\"Name\":\"SidHistory\",\"text\":\"-\"},{\"Name\":\"LogonHours\",\"text\":\"-\"},{\"Name\":\"DnsHostName\",\"text\":\"-\"},{\"Name\":\"ServicePrincipalNames\",\"text\":\"HOST/alice.insecurebank.local RestrictedKrbHost/alice.insecurebank.local HOST/ALICE RestrictedKrbHost/ALICE TERMSRV/alice.insecurebank.local TERMSRV/ALICE WSMAN/alice.insecurebank.local WSMAN/alice GC/alice.insecurebank.local/insecurebank.local E3514235-4B06-11D1-AB04-00C04FC2DCD2/ae9a3b29-01d1-4851-8ca8-e49cd3985e5b/insecurebank.local\"}]}}}", "category.generic": "Account", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield2": "host/alice.insecurebank.local restrictedkrbhost/alice.insecurebank.local host/alice restrictedkrbhost/alice termsrv/alice.insecurebank.local termsrv/alice wsman/alice.insecurebank.local wsman/alice gc/alice.insecurebank.local/insecurebank.local e3514235-4b06-11d1-ab04-00c04fc2dcd2/ae9a3b29-01d1-4851-8ca8-e49cd3985e5b/insecurebank.local", "event_src.category": "Directory service", "event_src.fqdn": "dc1.insecurebank.local", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4742_A_computer_account_was_changed", "importance": "low", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4742", "normalized": true, "object": "account", "object.account.domain": "insecurebank", "object.account.id": "S-1-5-21-738609754-2819869699-4189121830-1120", "object.account.name": "alice$", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-01T17:17:32.832Z", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "S-1-5-21-738609754-2819869699-4189121830-500", "subject.account.name": "administrator", "subject.account.session_id": "68724475", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-05-08T03:00:37.586Z", "type": "raw", "uuid": "69cc2855-b059-4b81-8290-55bbb8bd5595"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action": "modify", "alert.context": "e3514235-4b06-11d1-ab04-00c04fc2dcd2/ae9a3b29-01d1-4851-8ca8-e49cd3985e5b/insecurebank.local", "category.generic": "Attack", "category.high": "Defense Evasion", "category.low": "Rogue Domain Controller", "correlation_name": "DCShadow_Attack", "correlation_type": "incident", "datafield2": "host/alice.insecurebank.local restrictedkrbhost/alice.insecurebank.local host/alice restrictedkrbhost/alice termsrv/alice.insecurebank.local termsrv/alice wsman/alice.insecurebank.local wsman/alice gc/alice.insecurebank.local/insecurebank.local e3514235-4b06-11d1-ab04-00c04fc2dcd2/ae9a3b29-01d1-4851-8ca8-e49cd3985e5b/insecurebank.local", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "importance": "high", "object": "account", "object.account.domain": "insecurebank", "object.account.id": "S-1-5-21-738609754-2819869699-4189121830-1120", "object.account.name": "alice$", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "S-1-5-21-738609754-2819869699-4189121830-500", "subject.account.name": "administrator", "subject.account.session_id": "68724475"}