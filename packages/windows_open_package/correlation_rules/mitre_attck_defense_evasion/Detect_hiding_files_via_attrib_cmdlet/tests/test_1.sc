{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Sysmon\",\"Guid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\"},\"EventID\":\"1\",\"Version\":\"5\",\"Level\":\"4\",\"Task\":\"1\",\"Opcode\":\"0\",\"Keywords\":\"0x8000000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-05-19T17:32:00.4829823Z\"},\"EventRecordID\":\"22013\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"1768\",\"ThreadID\":\"2272\"},\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"Computer\":\"DC1.insecurebank.local\",\"Security\":{\"UserID\":\"S-1-5-18\"}},\"EventData\":{\"Data\":[{\"Name\":\"RuleName\",\"text\":\"technique_id=T1158,technique_name=Hidden Files and DirectoriesHidden Files and Directories\"},{\"Name\":\"UtcTime\",\"text\":\"2019-05-19 17:32:00.478\"},{\"Name\":\"ProcessGuid\",\"text\":\"{dfae8213-9310-5ce1-0000-0010eaba0a00}\"},{\"Name\":\"ProcessId\",\"text\":\"2728\"},{\"Name\":\"Image\",\"text\":\"C:\\\\Windows\\\\System32\\\\attrib.exe\"},{\"Name\":\"FileVersion\",\"text\":\"6.3.9600.16384 (winblue_rtm.130821-1623)\"},{\"Name\":\"Description\",\"text\":\"Attribute Utility\"},{\"Name\":\"Product\",\"text\":\"Microsoft® Windows® Operating System\"},{\"Name\":\"Company\",\"text\":\"Microsoft Corporation\"},{\"Name\":\"CommandLine\",\"text\":\"attrib +h nbtscan.exe\"},{\"Name\":\"CurrentDirectory\",\"text\":\"c:\\\\ProgramData\\\\\"},{\"Name\":\"User\",\"text\":\"insecurebank\\\\Administrator\"},{\"Name\":\"LogonGuid\",\"text\":\"{dfae8213-9133-5ce1-0000-0020cc660500}\"},{\"Name\":\"LogonId\",\"text\":\"0x566cc\"},{\"Name\":\"TerminalSessionId\",\"text\":\"2\"},{\"Name\":\"IntegrityLevel\",\"text\":\"High\"},{\"Name\":\"Hashes\",\"text\":\"SHA1=B71C1331AC5FA214076E5CD5C885712447057B96,MD5=116D463D2F5DBF76F7E2F5C6D8B5D3BB,SHA256=EBE94E294D86C714BED13EF018E70F75C37F8D8259144C0C847637EDC0222ECB,IMPHASH=461A33302E82ED68F1A74C083E27BD02\"},{\"Name\":\"ParentProcessGuid\",\"text\":\"{dfae8213-91cc-5ce1-0000-0010bef40600}\"},{\"Name\":\"ParentProcessId\",\"text\":\"3408\"},{\"Name\":\"ParentImage\",\"text\":\"C:\\\\Windows\\\\System32\\\\cmd.exe\"},{\"Name\":\"ParentCommandLine\",\"text\":\"\\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\\"\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "datafield6": "dfae8213-9133-5ce1-0000-0020cc660500", "event_src.category": "Other", "event_src.fqdn": "dc1.insecurebank.local", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "event_src.rule": "technique_id=T1158,technique_name=Hidden Files and DirectoriesHidden Files and Directories", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Sysmon_1_Process_creation", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "1", "normalized": true, "object": "process", "object.account.domain": "insecurebank", "object.account.id": "synthetic:administrator@insecurebank", "object.account.name": "administrator", "object.account.privileges": "High", "object.account.session_id": "353996", "object.process.cmdline": "attrib +h nbtscan.exe", "object.process.cwd": "c:\\ProgramData\\", "object.process.fullpath": "c:\\windows\\system32\\attrib.exe", "object.process.guid": "dfae8213-9310-5ce1-0000-0010eaba0a00", "object.process.hash.imphash": "461A33302E82ED68F1A74C083E27BD02", "object.process.hash.md5": "116D463D2F5DBF76F7E2F5C6D8B5D3BB", "object.process.hash.sha1": "B71C1331AC5FA214076E5CD5C885712447057B96", "object.process.hash.sha256": "EBE94E294D86C714BED13EF018E70F75C37F8D8259144C0C847637EDC0222ECB", "object.process.id": "2728", "object.process.meta": "Description:Attribute Utility | Product:Microsoft® Windows® Operating System | Company:Microsoft Corporation", "object.process.name": "attrib.exe", "object.process.parent.cmdline": "\"C:\\Windows\\system32\\cmd.exe\"", "object.process.parent.fullpath": "c:\\windows\\system32\\cmd.exe", "object.process.parent.guid": "dfae8213-91cc-5ce1-0000-0010bef40600", "object.process.parent.id": "3408", "object.process.parent.name": "cmd.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\windows\\system32\\", "object.process.version": "6.3.9600.16384 (winblue_rtm.130821-1623)", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-16T20:20:55.786Z", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "synthetic:administrator@insecurebank", "subject.account.name": "administrator", "subject.account.privileges": "High", "subject.account.session_id": "353996", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-05-19T17:32:00.478Z", "type": "raw", "uuid": "df5ffb59-a986-4363-a249-12900323391d"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 								{"action": "start", "category.generic": "Attack", "category.high": "Defence Evasion", "category.low": "Hide Artifacts: Hidden Files and Directories", "correlation_name": "Detect_hiding_files_via_attrib_cmdlet", "correlation_type": "event", "event_src.fqdn": "dc1.insecurebank.local", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "event_src.rule": "technique_id=T1158,technique_name=Hidden Files and DirectoriesHidden Files and Directories", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "Detect_hiding_files_via_attrib_cmdlet|dc1.insecurebank.local|attrib +h nbtscan.exe", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "service", "object.account.domain": "insecurebank", "object.account.id": "synthetic:administrator@insecurebank", "object.account.name": "administrator", "object.account.session_id": "353996", "object.process.cmdline": "attrib +h nbtscan.exe", "object.process.cwd": "c:\\ProgramData\\", "object.process.fullpath": "c:\\windows\\system32\\attrib.exe", "object.process.guid": "dfae8213-9310-5ce1-0000-0010eaba0a00", "object.process.hash.md5": "116D463D2F5DBF76F7E2F5C6D8B5D3BB", "object.process.hash.sha1": "B71C1331AC5FA214076E5CD5C885712447057B96", "object.process.hash.sha256": "EBE94E294D86C714BED13EF018E70F75C37F8D8259144C0C847637EDC0222ECB", "object.process.id": "2728", "object.process.meta": "Description:Attribute Utility | Product:Microsoft® Windows® Operating System | Company:Microsoft Corporation", "object.process.name": "attrib.exe", "object.process.parent.cmdline": "\"C:\\Windows\\system32\\cmd.exe\"", "object.process.parent.fullpath": "c:\\windows\\system32\\cmd.exe", "object.process.parent.guid": "dfae8213-91cc-5ce1-0000-0010bef40600", "object.process.parent.id": "3408", "object.process.parent.name": "cmd.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\windows\\system32\\", "object.process.version": "6.3.9600.16384 (winblue_rtm.130821-1623)", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "synthetic:administrator@insecurebank", "subject.account.name": "administrator", "subject.account.privileges": "High", "subject.account.session_id": "353996"}
							