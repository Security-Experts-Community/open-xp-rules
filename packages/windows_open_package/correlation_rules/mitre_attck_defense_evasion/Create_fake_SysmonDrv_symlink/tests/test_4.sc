{"action":"create","category.generic":"Service","category.high":"System Management","category.low":"Manipulation","event_src.category":"Operating system","event_src.fqdn":"win10-work.stand2008.local","event_src.host":"win10-work.stand2008.local","event_src.hostname":"win10-work","event_src.subsys":"Security","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"PT_Microsoft_Windows_eventlog_4697_A_service_was_installed_in_the_system","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"4697","normalized":true,"object":"service","object.account.name":"LocalSystem","object.name":"FakeDosDevice","object.process.fullpath":"E:\\work\\myproject\\proch\\x64\\Debug\\FakeDosDevice.exe","object.process.id":"14124","object.process.name":"FakeDosDevice.exe","object.process.parent.id":"7952","object.process.path":"E:\\work\\myproject\\proch\\x64\\Debug\\","object.property":"start type","object.type":"0x10","object.value":"2","recv_ipv4":"127.0.0.1","recv_time":"2024-05-27T14:31:05.568Z","status":"success","subject":"account","subject.account.domain":"stand2008","subject.account.id":"S-1-5-21-3800063338-4262557262-2801230003-500","subject.account.name":"администратор","subject.account.session_id":"757193","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2024-05-27T13:34:38.158Z","type":"raw","uuid":"3e296ac6-7401-49df-815b-e57fa7f43c53"}
{"action":"modify","category.generic":"Registry Object","category.high":"System Management","category.low":"Manipulation","event_src.category":"Other","event_src.fqdn":"win10-work.stand2008.local","event_src.host":"win10-work.stand2008.local","event_src.hostname":"win10-work","event_src.rule":"-","event_src.subsys":"Microsoft-Windows-Sysmon/Operational","event_src.title":"sysmon","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"PT_Microsoft_Windows_eventlog_Sysmon_13_Registry_value_changed","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"13","normalized":true,"object":"reg_object","object.fullpath":"\\registry\\machine\\system\\currentcontrolset\\services\\sysmon64\\dependonservice","object.name":"dependonservice","object.new_value":"fakedosdevice","object.path":"\\registry\\machine\\system\\currentcontrolset\\services\\sysmon64\\","object.property":"value","recv_ipv4":"127.0.0.1","recv_time":"2024-05-27T13:34:37.161Z","status":"success","subject.account.domain":"stand2008","subject.account.id":"synthetic:администратор@stand2008","subject.account.name":"администратор","subject.process.fullpath":"e:\\work\\myproject\\proch\\x64\\debug\\fakedosdevice.exe","subject.process.guid":"2b856446-7667-6658-e003-000000000c02","subject.process.id":"8480","subject.process.name":"fakedosdevice.exe","subject.process.path":"e:\\work\\myproject\\proch\\x64\\debug\\","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2024-05-27T13:34:37.161Z","type":"raw","uuid":"50a7c64a-aa8c-4387-b5fd-b34bb8d20780"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action":"modify","category.generic":"Attack","category.high":"Defense Evasion","category.low":"Impair Defenses","correlation_name":"Create_fake_SysmonDrv_symlink","correlation_type":"incident","count":1,"event_src.category":"Other","event_src.fqdn":"win10-work.stand2008.local","event_src.host":"win10-work.stand2008.local","event_src.hostname":"win10-work","event_src.subsys":"Microsoft-Windows-Sysmon/Operational","event_src.title":"sysmon","event_src.vendor":"microsoft","generator.type":"correlationengine","importance":"high","incident.aggregation.key":"Create_fake_SysmonDrv_symlink|win10-work.stand2008.local|synthetic:администратор@stand2008","incident.aggregation.timeout":7200,"incident.category":"ProtectionMalfunction","incident.severity":"high","normalized":true,"object":"reg_object","object.fullpath":"\\registry\\machine\\system\\currentcontrolset\\services\\sysmon64\\dependonservice","object.name":"dependonservice","object.new_value":"fakedosdevice","object.path":"\\registry\\machine\\system\\currentcontrolset\\services\\sysmon64\\","origin_app_id":"00000000-0000-0000-0000-000000000005","primary_siem_app_id":"00000000-0000-0000-0000-000000000005","status":"success","subject":"process","subject.account.domain":"stand2008","subject.account.id":"synthetic:администратор@stand2008","subject.account.name":"администратор","subject.process.fullpath":"e:\\work\\myproject\\proch\\x64\\debug\\fakedosdevice.exe","subject.process.name":"fakedosdevice.exe","subject.process.path":"e:\\work\\myproject\\proch\\x64\\debug\\","time":"2024-05-27T13:34:37.161Z"}