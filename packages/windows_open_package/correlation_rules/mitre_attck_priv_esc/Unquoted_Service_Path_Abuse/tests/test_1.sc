# Здесь укажи какие нормализованные события (одно или несколько) ты подаёшь на вход правилу корреляции.
# События отделяются друг от друга символом новой строки. Каждое их них должно быть записано в строку.
{ "action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Sysmon\",\"Guid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\"},\"EventID\":\"1\",\"Version\":\"5\",\"Level\":\"4\",\"Task\":\"1\",\"Opcode\":\"0\",\"Keywords\":\"0x8000000000000000\",\"TimeCreated\":{\"SystemTime\":\"2020-04-25T22:19:28.0807172Z\"},\"EventRecordID\":\"27636\",\"Correlation\":null,\"Execution\":{\"ProcessID\":\"2796\",\"ThreadID\":\"3572\"},\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"Computer\":\"MSEDGEWIN10\",\"Security\":{\"UserID\":\"S-1-5-18\"}},\"EventData\":{\"Data\":[{\"Name\":\"RuleName\",\"text\":\"PrivEsc - Potential Unquoted Service Exploit\"},{\"Name\":\"UtcTime\",\"text\":\"2020-04-25 22:19:18.317\"},{\"Name\":\"ProcessGuid\",\"text\":\"{747f3d96-b766-5ea4-0000-0010e7880100}\"},{\"Name\":\"ProcessId\",\"text\":\"2856\"},{\"Name\":\"Image\",\"text\":\"C:\\\\program.exe\"},{\"Name\":\"FileVersion\",\"text\":\"10.0.17763.592 (WinBuild.160101.0800)\"},{\"Name\":\"Description\",\"text\":\"Windows Command Processor\"},{\"Name\":\"Product\",\"text\":\"Microsoft® Windows® Operating System\"},{\"Name\":\"Company\",\"text\":\"Microsoft Corporation\"},{\"Name\":\"OriginalFileName\",\"text\":\"Cmd.Exe\"},{\"Name\":\"CommandLine\",\"text\":\"c:\\\\Program Files\\\\vulnsvc\\\\mmm.exe\"},{\"Name\":\"CurrentDirectory\",\"text\":\"C:\\\\Windows\\\\system32\\\\\"},{\"Name\":\"User\",\"text\":\"NT AUTHORITY\\\\SYSTEM\"},{\"Name\":\"LogonGuid\",\"text\":\"{747f3d96-b764-5ea4-0000-0020e7030000}\"},{\"Name\":\"LogonId\",\"text\":\"0x3e7\"},{\"Name\":\"TerminalSessionId\",\"text\":\"0\"},{\"Name\":\"IntegrityLevel\",\"text\":\"System\"},{\"Name\":\"Hashes\",\"text\":\"SHA1=8C5437CD76A89EC983E3B364E219944DA3DAB464,MD5=975B45B669930B0CC773EAF2B414206F,SHA256=3656F37A1C6951EC4496FABB8EE957D3A6E3C276D5A3785476B482C9C0D32EA2,IMPHASH=272245E2988E1E430500B852C4FB5E18\"},{\"Name\":\"ParentProcessGuid\",\"text\":\"{747f3d96-b764-5ea4-0000-00106f550000}\"},{\"Name\":\"ParentProcessId\",\"text\":\"584\"},{\"Name\":\"ParentImage\",\"text\":\"C:\\\\Windows\\\\System32\\\\services.exe\"},{\"Name\":\"ParentCommandLine\",\"text\":\"C:\\\\Windows\\\\system32\\\\services.exe\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "datafield6": "747f3d96-b764-5ea4-0000-0020e7030000", "event_src.category": "Other", "event_src.fqdn": "msedgewin10", "event_src.host": "msedgewin10", "event_src.hostname": "msedgewin10", "event_src.rule": "PrivEsc - Potential Unquoted Service Exploit", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Sysmon_1_Process_creation", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "1", "normalized": true, "object": "process", "object.account.domain": "nt authority", "object.account.id": "synthetic:system@nt authority", "object.account.name": "system", "object.account.privileges": "System", "object.account.session_id": "999", "object.process.cmdline": "c:\\Program Files\\vulnsvc\\mmm.exe", "object.process.cwd": "C:\\Windows\\system32\\", "object.process.fullpath": "c:\\program.exe", "object.process.guid": "747f3d96-b766-5ea4-0000-0010e7880100", "object.process.hash.imphash": "272245E2988E1E430500B852C4FB5E18", "object.process.hash.md5": "975B45B669930B0CC773EAF2B414206F", "object.process.hash.sha1": "8C5437CD76A89EC983E3B364E219944DA3DAB464", "object.process.hash.sha256": "3656F37A1C6951EC4496FABB8EE957D3A6E3C276D5A3785476B482C9C0D32EA2", "object.process.id": "2856", "object.process.meta": "Description:Windows Command Processor | Product:Microsoft® Windows® Operating System | Company:Microsoft Corporation", "object.process.name": "program.exe", "object.process.original_name": "Cmd.Exe", "object.process.parent.cmdline": "C:\\Windows\\system32\\services.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\services.exe", "object.process.parent.guid": "747f3d96-b764-5ea4-0000-00106f550000", "object.process.parent.id": "584", "object.process.parent.name": "services.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\", "object.process.version": "10.0.17763.592 (WinBuild.160101.0800)", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-07T17:28:14.503Z", "status": "success", "subject": "account", "subject.account.domain": "nt authority", "subject.account.id": "synthetic:system@nt authority", "subject.account.name": "system", "subject.account.privileges": "System", "subject.account.session_id": "999", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2020-04-25T22:19:18.317Z", "type": "raw", "uuid": "cfe86c74-2c29-4618-8dbf-fb8a14b34f3a" }

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 { "_rule": "Unquoted_Service_Path_Abuse", "correlation_name": "Unquoted_Service_Path_Abuse", "alert.key": "c:\\program.exe|c:\\program files\\vulnsvc\\mmm.exe"}