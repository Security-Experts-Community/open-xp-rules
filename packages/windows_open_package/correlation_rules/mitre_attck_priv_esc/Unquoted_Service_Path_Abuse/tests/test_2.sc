{"action": "start", "body": "{ \"Event\": { \"xmlns\": \"http://schemas.microsoft.com/win/2004/08/events/event\", \"System\": { \"Provider\": { \"Name\": \"Microsoft-Windows-Security-Auditing\", \"Guid\": \"{54849625-5478-4994-a5ba-3e3b0328c30d}\" }, \"EventID\": \"4688\", \"Version\": \"2\", \"Level\": \"0\", \"Task\": \"13312\", \"Opcode\": \"0\", \"Keywords\": \"0x8020000000000000\", \"TimeCreated\": { \"SystemTime\": \"2023-06-08T14:37:10.335665700Z\" }, \"EventRecordID\": \"50082171\", \"Correlation\": null, \"Execution\": { \"ProcessID\": \"4\", \"ThreadID\": \"2684\" }, \"Channel\": \"Security\", \"Computer\": \"wks05.example.com\", \"Security\": null }, \"EventData\": { \"Data\": [ { \"text\": \"S-1-5-18\", \"Name\": \"SubjectUserSid\" }, { \"text\": \"WKS05$\", \"Name\": \"SubjectUserName\" }, { \"text\": \"CYBERDYNE\", \"Name\": \"SubjectDomainName\" }, { \"text\": \"0x3e7\", \"Name\": \"SubjectLogonId\" }, { \"text\": \"0x1648\", \"Name\": \"NewProcessId\" }, { \"text\": \"C:\\\\ProgramData\\\\Simple Service\\\\simple.exe\", \"Name\": \"NewProcessName\" }, { \"text\": \"%%1936\", \"Name\": \"TokenElevationType\" }, { \"text\": \"0x288\", \"Name\": \"ProcessId\" }, { \"text\": \"\\\"C:\\\\ProgramData\\\\Simple Service\\\\Simple\\\" Service.exe\", \"Name\": \"CommandLine\" }, { \"text\": \"S-1-0-0\", \"Name\": \"TargetUserSid\" }, { \"text\": \"-\", \"Name\": \"TargetUserName\" }, { \"text\": \"-\", \"Name\": \"TargetDomainName\" }, { \"text\": \"0x0\", \"Name\": \"TargetLogonId\" }, { \"text\": \"C:\\\\Windows\\\\System32\\\\services.exe\", \"Name\": \"ParentProcessName\" }, { \"text\": \"S-1-16-16384\", \"Name\": \"MandatoryLabel\" } ] } } }", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "event_src.category": "Operating system", "event_src.fqdn": "wks05.example.com", "event_src.host": "wks05.example.com", "event_src.hostname": "wks05", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4688_A_new_process_has_been_created", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4688", "normalized": true, "object": "process", "object.account.domain": "cyberdyne", "object.account.id": "S-1-5-18", "object.account.name": "wks05$", "object.account.session_id": "999", "object.process.cmdline": "\"C:\\ProgramData\\Simple Service\\Simple\" Service.exe", "object.process.fullpath": "c:\\programdata\\simple service\\simple.exe", "object.process.id": "5704", "object.process.name": "simple.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\services.exe", "object.process.parent.id": "648", "object.process.parent.name": "services.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\programdata\\simple service\\", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-09T08:36:02.469Z", "status": "success", "subject": "account", "subject.account.domain": "cyberdyne", "subject.account.id": "S-1-5-18", "subject.account.name": "wks05$", "subject.account.privileges": "TokenElevationTypeDefault", "subject.account.session_id": "999", "subject.state": "on behalf of oneself", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-06-08T14:37:10.335Z", "type": "raw", "uuid": "d4a01206-bc5a-4dd4-824b-0cb47d1a2fbf"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 								{"action": "start", "alert.key": "c:\\programdata\\simple service\\simple.exe|\"c:\\programdata\\simple service\\simple\" service.exe", "category.generic": "Attack", "category.high": "Privilege Escalation", "category.low": "Hijack Execution Flow: Path Interception by Unquoted Path", "correlation_name": "Unquoted_Service_Path_Abuse", "correlation_type": "incident", "event_src.fqdn": "wks05.example.com", "event_src.host": "wks05.example.com", "event_src.hostname": "wks05", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "high", "incident.aggregation.key": "Unquoted_Service_Path_Abuse|c:\\programdata\\simple service\\simple.exe", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "high", "object": "process", "object.account.domain": "cyberdyne", "object.account.id": "S-1-5-18", "object.account.name": "wks05$", "object.account.session_id": "999", "object.process.cmdline": "\"C:\\ProgramData\\Simple Service\\Simple\" Service.exe", "object.process.fullpath": "c:\\programdata\\simple service\\simple.exe", "object.process.id": "5704", "object.process.name": "simple.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\services.exe", "object.process.parent.id": "648", "object.process.parent.name": "services.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\programdata\\simple service\\", "status": "success", "subject": "account", "subject.account.domain": "cyberdyne", "subject.account.id": "S-1-5-18", "subject.account.name": "wks05$", "subject.account.privileges": "TokenElevationTypeDefault", "subject.account.session_id": "999"}