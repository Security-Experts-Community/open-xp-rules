# Здесь укажи какие нормализованные события (одно или несколько) ты подаёшь на вход правилу корреляции.
# События отделяются друг от друга символом новой строки. Каждое их них должно быть записано в строку.
{"_checkpoint": 60837360029, "_meta": {"id": "ecb0611a-0604-01ee-9454-005056825a53", "time": "2023-06-08T14:01:08.9920000Z", "assetIds": ["1864e292-4880-0001-0000-000000000007"], "site_alias": "unknown site_id=null", "site_name": "unknown site_id=null", "site_address": "unknown site_id=null", "site_is_deleted": true}, "action": "start", "asset_ids": ["1864e292-4880-0001-0000-000000000007"], "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4688\",\"Version\":\"2\",\"Level\":\"0\",\"Task\":\"13312\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-06-08T14:01:08.992902900Z\"},\"EventRecordID\":\"50080921\",\"Correlation\":null,\"Execution\":{\"ProcessID\":\"4\",\"ThreadID\":\"292\"},\"Channel\":\"Security\",\"Computer\":\"wks05.example.com\",\"Security\":null},\"EventData\":{\"Data\":[{\"text\":\"S-1-5-18\",\"Name\":\"SubjectUserSid\"},{\"text\":\"WKS05$\",\"Name\":\"SubjectUserName\"},{\"text\":\"CYBERDYNE\",\"Name\":\"SubjectDomainName\"},{\"text\":\"0x3e7\",\"Name\":\"SubjectLogonId\"},{\"text\":\"0x138c\",\"Name\":\"NewProcessId\"},{\"text\":\"C:\\\\ProgramData\\\\simple.exe\",\"Name\":\"NewProcessName\"},{\"text\":\"%%1936\",\"Name\":\"TokenElevationType\"},{\"text\":\"0x288\",\"Name\":\"ProcessId\"},{\"text\":\"C:\\\\ProgramData\\\\Simple Service\\\\SimpleService.exe\",\"Name\":\"CommandLine\"},{\"text\":\"S-1-0-0\",\"Name\":\"TargetUserSid\"},{\"text\":\"-\",\"Name\":\"TargetUserName\"},{\"text\":\"-\",\"Name\":\"TargetDomainName\"},{\"text\":\"0x0\",\"Name\":\"TargetLogonId\"},{\"text\":\"C:\\\\Windows\\\\System32\\\\services.exe\",\"Name\":\"ParentProcessName\"},{\"text\":\"S-1-16-16384\",\"Name\":\"MandatoryLabel\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "datafield1": "999", "datafield19": "simple.exe (5004) (file creator: cmd.exe (4916) ← explorer.exe (4244) ← userinit.exe (4228) ← winlogon.exe (632) ← smss.exe (524) ← smss.exe (324)) ← services.exe (648) ← wininit.exe (532) ← smss.exe (420) ← smss.exe (324) ← system (4)", "datafield2": "648", "datafield3": "c:\\windows\\system32\\", "datafield4": "services.exe", "datafield5": "C:\\ProgramData\\Simple Service\\SimpleService.exe", "datafield7": "0", "event_src.asset": "1864e292-4880-0001-0000-000000000007", "event_src.category": "Operating system", "event_src.fqdn": "wks05.example.com", "event_src.host": "wks05.example.com", "event_src.hostname": "wks05", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2916", "historical": false, "id": "PT_Microsoft_Windows_eventlog_4688_A_new_process_has_been_created", "importance": "info", "incorrect_time": false, "input_id": "00000000-0000-0000-0000-000000000000", "job_id": "692db8c2-9d54-11eb-a8b3-0242ac130003", "mime": "application/x-pt-eventlog", "msgid": "4688", "normalized": true, "object": "process", "object.account.domain": "nt authority", "object.account.id": "S-1-5-18", "object.account.name": "system", "object.account.provider": "local", "object.account.session_id": "999", "object.id": "5004", "object.name": "simple.exe", "object.path": "c:\\programdata\\", "object.process.chain": "simple.exe (file creator: cmd.exe ← explorer.exe ← userinit.exe ← winlogon.exe ← smss.exe ← smss.exe) ← services.exe ← wininit.exe ← smss.exe ← smss.exe ← system", "object.process.cmdline": "C:\\ProgramData\\Simple Service\\SimpleService.exe", "object.process.fullpath": "c:\\programdata\\simple.exe", "object.process.id": "5004", "object.process.name": "simple.exe", "object.process.parent.cmdline": "C:\\Windows\\system32\\services.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\services.exe", "object.process.parent.id": "648", "object.process.parent.name": "services.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\programdata\\", "object.type": "elevated", "origin_app_alias": "MP-1", "origin_app_id": "185957ea-0f40-0001-0000-000000000002", "primary_siem_app_alias": "MP-1", "primary_siem_app_id": "185957ea-0f40-0001-0000-000000000002", "recv_asset": "1864e292-4880-0001-0000-000000000007", "recv_host": "wks05", "recv_ipv4": "2.3.4.5", "remote": false, "scope_id": "00000000-0000-0000-0000-000000000005", "siem_alias": "1.2.3.4", "siem_id": "e944c6fa-4174-4bb7-afae-98b42faee6b2", "site_address": "unknown site_id=null", "site_alias": "unknown site_id=null", "site_name": "unknown site_id=null", "status": "success", "subject": "account", "subject.account.domain": "nt authority", "subject.account.id": "S-1-5-18", "subject.account.name": "system", "subject.account.privileges": "TokenElevationTypeDefault", "subject.account.session_id": "999", "subject.domain": "cyberdyne", "subject.id": "S-1-5-18", "subject.name": "wks05$", "subject.privileges": "%%1936", "subject.state": "on behalf of oneself", "tag": "wineventlog", "tenant_id": "00000000-0000-0000-0000-000000000000", "time": "2023-06-08T14:01:08.9920000Z", "uuid": "ecb0611a-0604-01ee-9454-005056825a53"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"alert.key": "c:\\programdata\\simple.exe|c:\\programdata\\simple service\\simpleservice.exe", "correlation_name": "Unquoted_Service_Path_Abuse"}