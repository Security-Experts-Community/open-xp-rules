{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4688\",\"Version\":\"2\",\"Level\":\"0\",\"Task\":\"13312\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-06-02T12:19:09.7649521Z\"},\"EventRecordID\":\"25858687\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"4\",\"ThreadID\":\"8048\"},\"Channel\":\"Security\",\"Computer\":\"win10-work.stand2008.local\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-3800063338-4262557262-2801230003-500\"},{\"Name\":\"SubjectUserName\",\"text\":\"Администратор\"},{\"Name\":\"SubjectDomainName\",\"text\":\"STAND2008\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x1bb77ac\"},{\"Name\":\"NewProcessId\",\"text\":\"0x21b0\"},{\"Name\":\"NewProcessName\",\"text\":\"C:\\\\Windows\\\\System32\\\\cmd.exe\"},{\"Name\":\"TokenElevationType\",\"text\":\"%%1936\"},{\"Name\":\"ProcessId\",\"text\":\"0x25fc\"},{\"Name\":\"CommandLine\",\"text\":\"c:\\\\windows\\\\system32\\\\cmd.exe\"},{\"Name\":\"TargetUserSid\",\"text\":\"S-1-0-0\"},{\"Name\":\"TargetUserName\",\"text\":\"-\"},{\"Name\":\"TargetDomainName\",\"text\":\"-\"},{\"Name\":\"TargetLogonId\",\"text\":\"0x0\"},{\"Name\":\"ParentProcessName\",\"text\":\"C:\\\\Windows\\\\System32\\\\userinit.exe\"},{\"Name\":\"MandatoryLabel\",\"text\":\"S-1-16-12288\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "event_src.category": "Operating system", "event_src.fqdn": "win10-work.stand2008.local", "event_src.host": "win10-work.stand2008.local", "event_src.hostname": "win10-work", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4688_A_new_process_has_been_created", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4688", "normalized": true, "object": "process", "object.account.domain": "stand2008", "object.account.id": "S-1-5-21-3800063338-4262557262-2801230003-500", "object.account.name": "администратор", "object.account.session_id": "29063084", "object.process.cmdline": "c:\\windows\\system32\\cmd.exe", "object.process.fullpath": "c:\\windows\\system32\\cmd.exe", "object.process.id": "8624", "object.process.name": "cmd.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\userinit.exe", "object.process.parent.id": "9724", "object.process.parent.name": "userinit.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\windows\\system32\\", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-02T13:32:35.846Z", "status": "success", "subject": "account", "subject.account.domain": "stand2008", "subject.account.id": "S-1-5-21-3800063338-4262557262-2801230003-500", "subject.account.name": "администратор", "subject.account.privileges": "TokenElevationTypeDefault", "subject.account.session_id": "29063084", "subject.state": "on behalf of oneself", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-06-02T12:19:09.764Z", "type": "raw", "uuid": "16f6ac42-1656-4eb3-9f55-a3a4968856b1"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 								{"action": "start", "category.generic": "Persistence", "category.high": "Boot or Logon Autostart Execution", "category.low": "Winlogon Helper DLL", "correlation_name": "Use_persist_Start_process_via_WinlogonShell", "correlation_type": "incident", "event_src.fqdn": "win10-work.stand2008.local", "event_src.host": "win10-work.stand2008.local", "event_src.hostname": "win10-work", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "Use_persist_Start_process_via_WinlogonShell|win10-work.stand2008.local|s-1-5-21-3800063338-4262557262-2801230003-500", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "process", "object.account.domain": "stand2008", "object.account.id": "S-1-5-21-3800063338-4262557262-2801230003-500", "object.account.name": "администратор", "object.account.session_id": "29063084", "object.process.cmdline": "c:\\windows\\system32\\cmd.exe", "object.process.fullpath": "c:\\windows\\system32\\cmd.exe", "object.process.id": "8624", "object.process.name": "cmd.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\userinit.exe", "object.process.parent.id": "9724", "object.process.parent.name": "userinit.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\windows\\system32\\", "status": "success", "subject": "process", "subject.account.domain": "stand2008", "subject.account.id": "S-1-5-21-3800063338-4262557262-2801230003-500", "subject.account.name": "администратор", "subject.account.privileges": "TokenElevationTypeDefault", "subject.account.session_id": "29063084"}
