{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Sysmon\",\"Guid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\"},\"EventID\":\"1\",\"Version\":\"5\",\"Level\":\"4\",\"Task\":\"1\",\"Opcode\":\"0\",\"Keywords\":\"0x8000000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-06-14T22:23:13.9571207Z\"},\"EventRecordID\":\"7556\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"1960\",\"ThreadID\":\"288\"},\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"Computer\":\"IEWIN7\",\"Security\":{\"UserID\":\"S-1-5-18\"}},\"EventData\":{\"Data\":[{\"Name\":\"RuleName\"},{\"Name\":\"UtcTime\",\"text\":\"2019-06-14 22:23:13.925\"},{\"Name\":\"ProcessGuid\",\"text\":\"{365abb72-1e51-5d04-0000-00107b380c00}\"},{\"Name\":\"ProcessId\",\"text\":\"3444\"},{\"Name\":\"Image\",\"text\":\"C:\\\\Users\\\\IEUser\\\\AppData\\\\Roaming\\\\9QxTsAU9w8gyPj4w\\\\BRE6BgE2JubB.exe\"},{\"Name\":\"FileVersion\",\"text\":\"1.0.0.0\"},{\"Name\":\"Description\",\"text\":\"NpmTaskRunner\"},{\"Name\":\"Product\",\"text\":\"NpmTaskRunner\"},{\"Name\":\"Company\"},{\"Name\":\"CommandLine\",\"text\":\"\\\"C:\\\\Users\\\\IEUser\\\\AppData\\\\Roaming\\\\9QxTsAU9w8gyPj4w\\\\BRE6BgE2JubB.exe\\\"\"},{\"Name\":\"CurrentDirectory\",\"text\":\"C:\\\\Windows\\\\system32\\\\\"},{\"Name\":\"User\",\"text\":\"IEWIN7\\\\IEUser\"},{\"Name\":\"LogonGuid\",\"text\":\"{365abb72-1e4a-5d04-0000-002013c00b00}\"},{\"Name\":\"LogonId\",\"text\":\"0xbc013\"},{\"Name\":\"TerminalSessionId\",\"text\":\"2\"},{\"Name\":\"IntegrityLevel\",\"text\":\"High\"},{\"Name\":\"Hashes\",\"text\":\"SHA1=E2286C233467D0E164ED5ED1D07BAC9F90F74D19,MD5=41CE32C0D1D4E5BB8C63674F317450EF,SHA256=5DE788D23B247B29F116CD0583280CE10A429E9F8C1D80C42DEAB20C6F4DBB4E,IMPHASH=F34D5F2D4577ED6D9CEEC516C1F5A744\"},{\"Name\":\"ParentProcessGuid\",\"text\":\"{365abb72-1e51-5d04-0000-00104c340c00}\"},{\"Name\":\"ParentProcessId\",\"text\":\"3448\"},{\"Name\":\"ParentImage\",\"text\":\"C:\\\\Windows\\\\System32\\\\userinit.exe\"},{\"Name\":\"ParentCommandLine\",\"text\":\"C:\\\\Windows\\\\system32\\\\userinit.exe\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "datafield6": "365abb72-1e4a-5d04-0000-002013c00b00", "event_src.category": "Other", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Sysmon_1_Process_creation", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "1", "normalized": true, "object": "process", "object.account.domain": "iewin7", "object.account.id": "synthetic:ieuser@iewin7", "object.account.name": "ieuser", "object.account.privileges": "High", "object.account.session_id": "770067", "object.process.cmdline": "\"C:\\Users\\IEUser\\AppData\\Roaming\\9QxTsAU9w8gyPj4w\\BRE6BgE2JubB.exe\"", "object.process.cwd": "C:\\Windows\\system32\\", "object.process.fullpath": "c:\\users\\ieuser\\appdata\\roaming\\9qxtsau9w8gypj4w\\bre6bge2jubb.exe", "object.process.guid": "365abb72-1e51-5d04-0000-00107b380c00", "object.process.hash.imphash": "F34D5F2D4577ED6D9CEEC516C1F5A744", "object.process.hash.md5": "41CE32C0D1D4E5BB8C63674F317450EF", "object.process.hash.sha1": "E2286C233467D0E164ED5ED1D07BAC9F90F74D19", "object.process.hash.sha256": "5DE788D23B247B29F116CD0583280CE10A429E9F8C1D80C42DEAB20C6F4DBB4E", "object.process.id": "3444", "object.process.meta": "Description:NpmTaskRunner | Product:NpmTaskRunner | Company:", "object.process.name": "bre6bge2jubb.exe", "object.process.parent.cmdline": "C:\\Windows\\system32\\userinit.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\userinit.exe", "object.process.parent.guid": "365abb72-1e51-5d04-0000-00104c340c00", "object.process.parent.id": "3448", "object.process.parent.name": "userinit.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\users\\ieuser\\appdata\\roaming\\9qxtsau9w8gypj4w\\", "object.process.version": "1.0.0.0", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-02T13:21:52.432Z", "status": "success", "subject": "account", "subject.account.domain": "iewin7", "subject.account.id": "synthetic:ieuser@iewin7", "subject.account.name": "ieuser", "subject.account.privileges": "High", "subject.account.session_id": "770067", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-06-14T22:23:13.925Z", "type": "raw", "uuid": "fa1f6a22-a663-4e1c-aef9-e09d7c0168ce"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 								{"action": "start", "category.generic": "Persistence", "category.high": "Boot or Logon Autostart Execution", "category.low": "Winlogon Helper DLL", "correlation_name": "Use_persist_Start_process_via_WinlogonShell", "correlation_type": "incident", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "Use_persist_Start_process_via_WinlogonShell|iewin7|synthetic:ieuser@iewin7", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "process", "object.account.domain": "iewin7", "object.account.id": "synthetic:ieuser@iewin7", "object.account.name": "ieuser", "object.account.session_id": "770067", "object.process.cmdline": "\"C:\\Users\\IEUser\\AppData\\Roaming\\9QxTsAU9w8gyPj4w\\BRE6BgE2JubB.exe\"", "object.process.cwd": "C:\\Windows\\system32\\", "object.process.fullpath": "c:\\users\\ieuser\\appdata\\roaming\\9qxtsau9w8gypj4w\\bre6bge2jubb.exe", "object.process.hash.md5": "41CE32C0D1D4E5BB8C63674F317450EF", "object.process.hash.sha1": "E2286C233467D0E164ED5ED1D07BAC9F90F74D19", "object.process.hash.sha256": "5DE788D23B247B29F116CD0583280CE10A429E9F8C1D80C42DEAB20C6F4DBB4E", "object.process.id": "3444", "object.process.meta": "Description:NpmTaskRunner | Product:NpmTaskRunner | Company:", "object.process.name": "bre6bge2jubb.exe", "object.process.parent.cmdline": "C:\\Windows\\system32\\userinit.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\userinit.exe", "object.process.parent.id": "3448", "object.process.parent.name": "userinit.exe", "object.process.parent.path": "c:\\windows\\system32\\", "object.process.path": "c:\\users\\ieuser\\appdata\\roaming\\9qxtsau9w8gypj4w\\", "object.process.version": "1.0.0.0", "status": "success", "subject": "process", "subject.account.domain": "iewin7", "subject.account.id": "synthetic:ieuser@iewin7", "subject.account.name": "ieuser", "subject.account.privileges": "High", "subject.account.session_id": "770067"}