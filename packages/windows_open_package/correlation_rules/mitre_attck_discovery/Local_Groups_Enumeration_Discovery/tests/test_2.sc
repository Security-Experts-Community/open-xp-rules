{"action": "view", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4799\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13826\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-01-24T11:52:02.1550291Z\"},\"EventRecordID\":\"3819707\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"724\",\"ThreadID\":\"10848\"},\"Channel\":\"Security\",\"Computer\":\"01566s-win16-ir.threebeesco.com\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"TargetUserName\",\"text\":\"Administrators\"},{\"Name\":\"TargetDomainName\",\"text\":\"Builtin\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-32-544\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-308926384-506822093-3341789130-1105\"},{\"Name\":\"SubjectUserName\",\"text\":\"jbrown\"},{\"Name\":\"SubjectDomainName\",\"text\":\"3B\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x23ec715\"},{\"Name\":\"CallerProcessId\",\"text\":\"0x23e8\"},{\"Name\":\"CallerProcessName\",\"text\":\"C:\\\\Windows\\\\System32\\\\net1.exe\"}]}}}", "category.generic": "Group", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield1": "37668629", "datafield2": "9192", "datafield3": "C:\\Windows\\System32\\net1.exe", "datafield4": "net1.exe", "event_src.category": "Operating system", "event_src.fqdn": "01566s-win16-ir.threebeesco.com", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4799_Process_enumerates_members_of_security_enabled", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4799", "normalized": true, "object": "user_group", "object.id": "S-1-5-32-544", "object.name": "Administrators", "object.type": "local security-enabled", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-03T21:23:30.339Z", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown", "subject.account.session_id": "37668629", "subject.domain": "3b", "subject.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.name": "jbrown", "subject.process.fullpath": "C:\\Windows\\System32\\net1.exe", "subject.process.id": "9192", "subject.process.name": "net1.exe", "subject.process.path": "C:\\Windows\\System32\\", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-01-24T11:52:02.155Z", "type": "raw", "uuid": "ebbd935b-17e0-437a-b7d9-5e9a5cc2574f"}
{"action": "view", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4799\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13826\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-01-24T11:53:14.3990509Z\"},\"EventRecordID\":\"3819735\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"724\",\"ThreadID\":\"2604\"},\"Channel\":\"Security\",\"Computer\":\"01566s-win16-ir.threebeesco.com\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"TargetUserName\",\"text\":\"Administrators\"},{\"Name\":\"TargetDomainName\",\"text\":\"Builtin\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-32-544\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-308926384-506822093-3341789130-1105\"},{\"Name\":\"SubjectUserName\",\"text\":\"jbrown\"},{\"Name\":\"SubjectDomainName\",\"text\":\"3B\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x2be6273\"},{\"Name\":\"CallerProcessId\",\"text\":\"0x0\"},{\"Name\":\"CallerProcessName\",\"text\":\"-\"}]}}}", "category.generic": "Group", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield1": "46031475", "datafield2": "0", "datafield3": "-", "datafield4": "-", "event_src.category": "Operating system", "event_src.fqdn": "01566s-win16-ir.threebeesco.com", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4799_Process_enumerates_members_of_security_enabled", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4799", "normalized": true, "object": "user_group", "object.id": "S-1-5-32-544", "object.name": "Administrators", "object.type": "local security-enabled", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-03T21:23:30.339Z", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown", "subject.account.session_id": "46031475", "subject.domain": "3b", "subject.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.name": "jbrown", "subject.process.fullpath": "-", "subject.process.id": "0", "subject.process.name": "-", "subject.process.path": "", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-01-24T11:53:14.399Z", "type": "raw", "uuid": "7845c35f-2cd9-4d34-8d17-3716eda09c4e"}
{"action": "view", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4799\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13826\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-01-24T11:54:02.4164913Z\"},\"EventRecordID\":\"3819752\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"724\",\"ThreadID\":\"2604\"},\"Channel\":\"Security\",\"Computer\":\"01566s-win16-ir.threebeesco.com\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"TargetUserName\",\"text\":\"Administrators\"},{\"Name\":\"TargetDomainName\",\"text\":\"Builtin\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-32-544\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-308926384-506822093-3341789130-1105\"},{\"Name\":\"SubjectUserName\",\"text\":\"jbrown\"},{\"Name\":\"SubjectDomainName\",\"text\":\"3B\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x2bf470d\"},{\"Name\":\"CallerProcessId\",\"text\":\"0x0\"},{\"Name\":\"CallerProcessName\",\"text\":\"-\"}]}}}", "category.generic": "Group", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield1": "46089997", "datafield2": "0", "datafield3": "-", "datafield4": "-", "event_src.category": "Operating system", "event_src.fqdn": "01566s-win16-ir.threebeesco.com", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4799_Process_enumerates_members_of_security_enabled", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4799", "normalized": true, "object": "user_group", "object.id": "S-1-5-32-544", "object.name": "Administrators", "object.type": "local security-enabled", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-03T21:23:30.339Z", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown", "subject.account.session_id": "46089997", "subject.domain": "3b", "subject.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.name": "jbrown", "subject.process.fullpath": "-", "subject.process.id": "0", "subject.process.name": "-", "subject.process.path": "", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-01-24T11:54:02.416Z", "type": "raw", "uuid": "9dc13012-355d-48a2-bbf4-0f48346b9fe5"}
{"action": "view", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4799\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13826\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-01-24T11:54:18.0016387Z\"},\"EventRecordID\":\"3819771\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"724\",\"ThreadID\":\"2604\"},\"Channel\":\"Security\",\"Computer\":\"01566s-win16-ir.threebeesco.com\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"TargetUserName\",\"text\":\"Remote Desktop Users\"},{\"Name\":\"TargetDomainName\",\"text\":\"Builtin\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-32-555\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-308926384-506822093-3341789130-1105\"},{\"Name\":\"SubjectUserName\",\"text\":\"jbrown\"},{\"Name\":\"SubjectDomainName\",\"text\":\"3B\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x2bfa357\"},{\"Name\":\"CallerProcessId\",\"text\":\"0x0\"},{\"Name\":\"CallerProcessName\",\"text\":\"-\"}]}}}", "category.generic": "Group", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield1": "46113623", "datafield2": "0", "datafield3": "-", "datafield4": "-", "event_src.category": "Operating system", "event_src.fqdn": "01566s-win16-ir.threebeesco.com", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4799_Process_enumerates_members_of_security_enabled", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4799", "normalized": true, "object": "user_group", "object.id": "S-1-5-32-555", "object.name": "Remote Desktop Users", "object.type": "local security-enabled", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-03T21:23:30.339Z", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown", "subject.account.session_id": "46113623", "subject.domain": "3b", "subject.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.name": "jbrown", "subject.process.fullpath": "-", "subject.process.id": "0", "subject.process.name": "-", "subject.process.path": "", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-01-24T11:54:18.001Z", "type": "raw", "uuid": "708ada5b-c2df-409a-8736-a5e015251801"}
{"action": "view", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4799\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"13826\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-01-24T11:54:42.8999934Z\"},\"EventRecordID\":\"3819788\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"724\",\"ThreadID\":\"10940\"},\"Channel\":\"Security\",\"Computer\":\"01566s-win16-ir.threebeesco.com\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"TargetUserName\",\"text\":\"Users\"},{\"Name\":\"TargetDomainName\",\"text\":\"Builtin\"},{\"Name\":\"TargetSid\",\"text\":\"S-1-5-32-545\"},{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-308926384-506822093-3341789130-1105\"},{\"Name\":\"SubjectUserName\",\"text\":\"jbrown\"},{\"Name\":\"SubjectDomainName\",\"text\":\"3B\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x2c00357\"},{\"Name\":\"CallerProcessId\",\"text\":\"0x0\"},{\"Name\":\"CallerProcessName\",\"text\":\"-\"}]}}}", "category.generic": "Group", "category.high": "Users And Rights Management", "category.low": "Manipulation", "datafield1": "46138199", "datafield2": "0", "datafield3": "-", "datafield4": "-", "event_src.category": "Operating system", "event_src.fqdn": "01566s-win16-ir.threebeesco.com", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4799_Process_enumerates_members_of_security_enabled", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4799", "normalized": true, "object": "user_group", "object.id": "S-1-5-32-545", "object.name": "Users", "object.type": "local security-enabled", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-03T21:23:30.339Z", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown", "subject.account.session_id": "46138199", "subject.domain": "3b", "subject.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.name": "jbrown", "subject.process.fullpath": "-", "subject.process.id": "0", "subject.process.name": "-", "subject.process.path": "", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-01-24T11:54:42.899Z", "type": "raw", "uuid": "dd71f5fe-1c97-429e-975d-ed21c6198fb1"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 5 {"action": "read", "category.generic": "Attack", "category.high": "Discovery", "category.low": "Account Discovery", "correlation_name": "Local_Groups_Enumeration_Discovery", "correlation_type": "event", "event_src.category": "Operating system", "event_src.host": "01566s-win16-ir.threebeesco.com", "event_src.hostname": "01566s-win16-ir", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "low", "object": "user_group", "object.type": "local security-enabled", "status": "success", "subject": "account", "subject.account.domain": "3b", "subject.account.id": "S-1-5-21-308926384-506822093-3341789130-1105", "subject.account.name": "jbrown"}
							