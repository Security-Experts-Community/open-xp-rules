{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Sysmon\",\"Guid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\"},\"EventID\":\"1\",\"Version\":\"5\",\"Level\":\"4\",\"Task\":\"1\",\"Opcode\":\"0\",\"Keywords\":\"0x8000000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-05-28T02:14:50.4136318Z\"},\"EventRecordID\":\"6414\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"548\",\"ThreadID\":\"2444\"},\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"Computer\":\"IEWIN7\",\"Security\":{\"UserID\":\"S-1-5-18\"}},\"EventData\":{\"Data\":[{\"Name\":\"RuleName\"},{\"Name\":\"UtcTime\",\"text\":\"2019-05-28 02:14:50.390\"},{\"Name\":\"ProcessGuid\",\"text\":\"{365abb72-999a-5cec-0000-0010c3a11700}\"},{\"Name\":\"ProcessId\",\"text\":\"1516\"},{\"Name\":\"Image\",\"text\":\"C:\\\\Windows\\\\System32\\\\notepad.exe\"},{\"Name\":\"FileVersion\",\"text\":\"6.1.7600.16385 (win7_rtm.090713-1255)\"},{\"Name\":\"Description\",\"text\":\"Notepad\"},{\"Name\":\"Product\",\"text\":\"Microsoft® Windows® Operating System\"},{\"Name\":\"Company\",\"text\":\"Microsoft Corporation\"},{\"Name\":\"CommandLine\",\"text\":\"\\\"c:\\\\windows\\\\System32\\\\notepad.exe\\\"\"},{\"Name\":\"CurrentDirectory\",\"text\":\"c:\\\\ProgramData\\\\\"},{\"Name\":\"User\",\"text\":\"IEWIN7\\\\IEUser\"},{\"Name\":\"LogonGuid\",\"text\":\"{365abb72-82ec-5cec-0000-0020734a0100}\"},{\"Name\":\"LogonId\",\"text\":\"0x14a73\"},{\"Name\":\"TerminalSessionId\",\"text\":\"1\"},{\"Name\":\"IntegrityLevel\",\"text\":\"High\"},{\"Name\":\"Hashes\",\"text\":\"SHA1=FC64B1EF19E7F35642B2A2EA5F5D9F4246866243,MD5=A4F6DF0E33E644E802C8798ED94D80EA,SHA256=B56AFE7165AD341A749D2D3BD925D879728A1FE4A4DF206145C1A69AA233F68B,IMPHASH=53A6715F589E88C4FD4541C81B4F57C3\"},{\"Name\":\"ParentProcessGuid\",\"text\":\"{365abb72-9998-5cec-0000-00107d501700}\"},{\"Name\":\"ParentProcessId\",\"text\":\"3092\"},{\"Name\":\"ParentImage\",\"text\":\"C:\\\\ProgramData\\\\vshadow.exe\"},{\"Name\":\"ParentCommandLine\",\"text\":\"vshadow.exe -nw -exec=c:\\\\windows\\\\System32\\\\notepad.exe c:\\\\\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "datafield6": "365abb72-82ec-5cec-0000-0020734a0100", "event_src.category": "Other", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Sysmon_1_Process_creation", "importance": "info", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "1", "normalized": true, "object": "process", "object.account.domain": "iewin7", "object.account.id": "synthetic:ieuser@iewin7", "object.account.name": "ieuser", "object.account.privileges": "High", "object.account.session_id": "84595", "object.process.cmdline": "\"c:\\windows\\System32\\notepad.exe\"", "object.process.cwd": "c:\\ProgramData\\", "object.process.fullpath": "c:\\windows\\system32\\notepad.exe", "object.process.guid": "365abb72-999a-5cec-0000-0010c3a11700", "object.process.hash.imphash": "53A6715F589E88C4FD4541C81B4F57C3", "object.process.hash.md5": "A4F6DF0E33E644E802C8798ED94D80EA", "object.process.hash.sha1": "FC64B1EF19E7F35642B2A2EA5F5D9F4246866243", "object.process.hash.sha256": "B56AFE7165AD341A749D2D3BD925D879728A1FE4A4DF206145C1A69AA233F68B", "object.process.id": "1516", "object.process.meta": "Description:Notepad | Product:Microsoft® Windows® Operating System | Company:Microsoft Corporation", "object.process.name": "notepad.exe", "object.process.parent.cmdline": "vshadow.exe -nw -exec=c:\\windows\\System32\\notepad.exe c:\\", "object.process.parent.fullpath": "c:\\programdata\\vshadow.exe", "object.process.parent.guid": "365abb72-9998-5cec-0000-00107d501700", "object.process.parent.id": "3092", "object.process.parent.name": "vshadow.exe", "object.process.parent.path": "c:\\programdata\\", "object.process.path": "c:\\windows\\system32\\", "object.process.version": "6.1.7600.16385 (win7_rtm.090713-1255)", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-05T11:42:05.596Z", "status": "success", "subject": "account", "subject.account.domain": "iewin7", "subject.account.id": "synthetic:ieuser@iewin7", "subject.account.name": "ieuser", "subject.account.privileges": "High", "subject.account.session_id": "84595", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-05-28T02:14:50.390Z", "type": "raw", "uuid": "a5783593-a6fe-45c5-8aad-adf29c9ebb39"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 								{"action": "start", "category.generic": "Attack", "category.high": "Execution", "category.low": "System Services: Service Execution", "correlation_name": "Start_process_as_vshadow_child", "correlation_type": "incident", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "Start_process_as_vshadow_child|iewin7|synthetic:ieuser@iewin7", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "process", "object.account.domain": "iewin7", "object.account.id": "synthetic:ieuser@iewin7", "object.account.name": "ieuser", "object.account.session_id": "84595", "object.process.cmdline": "\"c:\\windows\\System32\\notepad.exe\"", "object.process.cwd": "c:\\ProgramData\\", "object.process.fullpath": "c:\\windows\\system32\\notepad.exe", "object.process.guid": "365abb72-999a-5cec-0000-0010c3a11700", "object.process.hash.md5": "A4F6DF0E33E644E802C8798ED94D80EA", "object.process.hash.sha1": "FC64B1EF19E7F35642B2A2EA5F5D9F4246866243", "object.process.hash.sha256": "B56AFE7165AD341A749D2D3BD925D879728A1FE4A4DF206145C1A69AA233F68B", "object.process.id": "1516", "object.process.meta": "Description:Notepad | Product:Microsoft® Windows® Operating System | Company:Microsoft Corporation", "object.process.name": "notepad.exe", "object.process.parent.cmdline": "vshadow.exe -nw -exec=c:\\windows\\System32\\notepad.exe c:\\", "object.process.parent.fullpath": "c:\\programdata\\vshadow.exe", "object.process.parent.guid": "365abb72-9998-5cec-0000-00107d501700", "object.process.parent.id": "3092", "object.process.parent.name": "vshadow.exe", "object.process.parent.path": "c:\\programdata\\", "object.process.path": "c:\\windows\\system32\\", "object.process.version": "6.1.7600.16385 (win7_rtm.090713-1255)", "status": "success", "subject": "account", "subject.account.domain": "iewin7", "subject.account.id": "synthetic:ieuser@iewin7", "subject.account.name": "ieuser", "subject.account.privileges": "High", "subject.account.session_id": "84595"}
