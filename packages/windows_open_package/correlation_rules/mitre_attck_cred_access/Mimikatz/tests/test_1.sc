{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\"},\"EventID\":\"4688\",\"Version\":\"2\",\"Level\":\"0\",\"Task\":\"13312\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2020-01-23T10:18:31.616030800Z\"},\"EventRecordID\":\"6925090\",\"Correlation\":null,\"Execution\":{\"ProcessID\":\"4\",\"ThreadID\":\"5460\"},\"Channel\":\"Security\",\"Computer\":\"WIN10X64-133.testlab.org\",\"Security\":null},\"EventData\":{\"Data\":[{\"text\":\"S-1-5-21-3389064948-2957360831-125328159-1105\",\"Name\":\"SubjectUserSid\"},{\"text\":\"test-admin\",\"Name\":\"SubjectUserName\"},{\"text\":\"TESTLAB\",\"Name\":\"SubjectDomainName\"},{\"text\":\"0x1c3869\",\"Name\":\"SubjectLogonId\"},{\"text\":\"0xb28\",\"Name\":\"NewProcessId\"},{\"text\":\"C:\\\\Users\\\\test-admin\\\\Documents\\\\Tools for raw events\\\\mimikatz\\\\x64\\\\mimikatz.exe\",\"Name\":\"NewProcessName\"},{\"text\":\"%%1937\",\"Name\":\"TokenElevationType\"},{\"text\":\"0x1530\",\"Name\":\"ProcessId\"},{\"text\":\"\\\"C:\\\\Users\\\\test-admin\\\\Documents\\\\Tools for raw events\\\\mimikatz\\\\x64\\\\mimikatz.exe\\\" privilege::debug\",\"Name\":\"CommandLine\"},{\"text\":\"S-1-0-0\",\"Name\":\"TargetUserSid\"},{\"text\":\"-\",\"Name\":\"TargetUserName\"},{\"text\":\"-\",\"Name\":\"TargetDomainName\"},{\"text\":\"0x0\",\"Name\":\"TargetLogonId\"},{\"text\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\",\"Name\":\"ParentProcessName\"},{\"text\":\"S-1-16-12288\",\"Name\":\"MandatoryLabel\"}]}}}", "category.generic": "Process", "category.high": "Availability Management", "category.low": "Control", "event_src.category": "Operating system", "event_src.fqdn": "win10x64-133.testlab.org", "event_src.host": "win10x64-133.testlab.org", "event_src.hostname": "win10x64-133", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "historical": false, "id": "PT_Microsoft_Windows_eventlog_4688_A_new_process_has_been_created", "importance": "info", "input_id": "d8c86b6f-83bf-4c13-921b-a8403077119a", "job_id": "a4d09d11-927a-4cb6-9f4f-971106247fdd", "mime": "application/x-pt-eventlog", "msgid": "4688", "normalized": true, "object": "process", "object.account.domain": "testlab", "object.account.id": "S-1-5-21-3389064948-2957360831-125328159-1105", "object.account.name": "test-admin", "object.account.session_id": "1849449", "object.process.cmdline": "\"C:\\Users\\test-admin\\Documents\\Tools for raw events\\mimikatz\\x64\\mimikatz.exe\" privilege::debug", "object.process.fullpath": "c:\\users\\test-admin\\documents\\tools for raw events\\mimikatz\\x64\\mimikatz.exe", "object.process.id": "2856", "object.process.name": "mimikatz.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "object.process.parent.id": "5424", "object.process.parent.name": "powershell.exe", "object.process.parent.path": "c:\\windows\\system32\\windowspowershell\\v1.0\\", "object.process.path": "c:\\users\\test-admin\\documents\\tools for raw events\\mimikatz\\x64\\", "recv_ipv4": "192.168.40.146", "recv_time": "2020-01-27T06:12:53Z", "status": "success", "subject": "account", "subject.account.domain": "testlab", "subject.account.id": "S-1-5-21-3389064948-2957360831-125328159-1105", "subject.account.name": "test-admin", "subject.account.privileges": "TokenElevationTypeFull", "subject.account.session_id": "1849449", "subject.state": "on behalf of oneself", "tag": "wineventlog", "taxonomy_version": "26.0.215-release-26.0", "time": "2020-01-23T10:18:31.616Z", "uuid": "00000005-e2e7-0f65-f000-0000119dd0a4"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action": "start", "category.generic": "Attack", "category.high": "Credential Access", "category.low": "OS Credential Dumping", "correlation_name": "Mimikatz", "correlation_type": "incident", "event_src.fqdn": "win10x64-133.testlab.org", "event_src.host": "win10x64-133.testlab.org", "event_src.hostname": "win10x64-133", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "Mimikatz|win10x64-133.testlab.org|s-1-5-21-3389064948-2957360831-125328159-1105", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "process", "object.account.domain": "testlab", "object.account.id": "S-1-5-21-3389064948-2957360831-125328159-1105", "object.account.name": "test-admin", "object.account.session_id": "1849449", "object.process.cmdline": "\"C:\\Users\\test-admin\\Documents\\Tools for raw events\\mimikatz\\x64\\mimikatz.exe\" privilege::debug", "object.process.fullpath": "c:\\users\\test-admin\\documents\\tools for raw events\\mimikatz\\x64\\mimikatz.exe", "object.process.id": "2856", "object.process.name": "mimikatz.exe", "object.process.parent.fullpath": "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "object.process.parent.id": "5424", "object.process.parent.name": "powershell.exe", "object.process.parent.path": "c:\\windows\\system32\\windowspowershell\\v1.0\\", "object.process.path": "c:\\users\\test-admin\\documents\\tools for raw events\\mimikatz\\x64\\", "status": "success", "subject": "account", "subject.account.domain": "testlab", "subject.account.id": "S-1-5-21-3389064948-2957360831-125328159-1105", "subject.account.name": "test-admin", "subject.account.privileges": "TokenElevationTypeFull", "subject.account.session_id": "1849449"}
