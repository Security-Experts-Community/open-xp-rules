{"action": "access", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\"},\"EventID\":\"4662\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"14080\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-05-08T02:10:43.4872170Z\"},\"EventRecordID\":\"202792\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"444\",\"ThreadID\":\"4632\"},\"Channel\":\"Security\",\"Computer\":\"DC1.insecurebank.local\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-21-738609754-2819869699-4189121830-500\"},{\"Name\":\"SubjectUserName\",\"text\":\"Administrator\"},{\"Name\":\"SubjectDomainName\",\"text\":\"insecurebank\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x40c6511\"},{\"Name\":\"ObjectServer\",\"text\":\"DS\"},{\"Name\":\"ObjectType\",\"text\":\"%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\"},{\"Name\":\"ObjectName\",\"text\":\"%{c6faf700-bfe4-452a-a766-424f84c29583}\"},{\"Name\":\"OperationType\",\"text\":\"Object Access\"},{\"Name\":\"HandleId\",\"text\":\"0x0\"},{\"Name\":\"AccessList\",\"text\":\"%%7688\"},{\"Name\":\"AccessMask\",\"text\":\"0x100\"},{\"Name\":\"Properties\",\"text\":\"%%7688 {1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} {19195a5b-6da0-11d0-afd3-00c04fd930c9}\"},{\"Name\":\"AdditionalInfo\",\"text\":\"-\"},{\"Name\":\"AdditionalInfo2\"}]}}}", "category.generic": "Directory Service Object", "category.high": "System Management", "category.low": "Manipulation", "datafield2": "%%7688 {1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} {19195a5b-6da0-11d0-afd3-00c04fd930c9}", "datafield5": "0x100", "event_src.category": "Operating system", "event_src.fqdn": "dc1.insecurebank.local", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4662_An_operation_was_performed_on_an_object", "importance": "medium", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4662", "normalized": true, "object": "ds_object", "object.name": "c6faf700-bfe4-452a-a766-424f84c29583", "object.type": "19195a5b-6da0-11d0-afd3-00c04fd930c9", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-05T20:04:28.295Z", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "S-1-5-21-738609754-2819869699-4189121830-500", "subject.account.name": "administrator", "subject.account.session_id": "67921169", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-05-08T02:10:43.487Z", "type": "raw", "uuid": "03448835-b4b4-45de-b26a-063bc09f0e3b"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action": "sync", "category.generic": "Attack", "category.high": "Credential Access", "category.low": "OS Credential Dumping: DCSync", "correlation_name": "DCSync", "correlation_type": "incident", "datafield2": "%%7688 {1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} {19195a5b-6da0-11d0-afd3-00c04fd930c9}", "datafield5": "0x100", "event_src.category": "Operating system", "event_src.host": "dc1.insecurebank.local", "event_src.hostname": "dc1", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "high", "incident.aggregation.key": "DCSync|dc1.insecurebank.local|administrator", "incident.aggregation.timeout": 600, "incident.category": "Undefined", "incident.severity": "high", "object": "account", "status": "success", "subject": "account", "subject.account.domain": "insecurebank", "subject.account.id": "S-1-5-21-738609754-2819869699-4189121830-500", "subject.account.name": "administrator", "subject.account.session_id": "67921169"}
