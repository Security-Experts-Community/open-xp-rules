{"action": "access", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Security-Auditing\",\"Guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\"},\"EventID\":\"4662\",\"Version\":\"0\",\"Level\":\"0\",\"Task\":\"14080\",\"Opcode\":\"0\",\"Keywords\":\"0x8020000000000000\",\"TimeCreated\":{\"SystemTime\":\"2023-06-05T19:35:22.922776200Z\"},\"EventRecordID\":\"102112089\",\"Correlation\":{\"ActivityID\":\"{4B14F9AC-0BA9-4809-8483-1083DDB10886}\"},\"Execution\":{\"ProcessID\":\"572\",\"ThreadID\":\"8132\"},\"Channel\":\"Security\",\"Computer\":\"ecsb003006a9.dc.atomic.local\",\"Security\":\"\"},\"EventData\":{\"Data\":[{\"Name\":\"SubjectUserSid\",\"text\":\"S-1-5-18\"},{\"Name\":\"SubjectUserName\",\"text\":\"ECSB003006A9$\"},{\"Name\":\"SubjectDomainName\",\"text\":\"DC\"},{\"Name\":\"SubjectLogonId\",\"text\":\"0x164d623881\"},{\"Name\":\"ObjectServer\",\"text\":\"DS\"},{\"Name\":\"ObjectType\",\"text\":\"%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\"},{\"Name\":\"ObjectName\",\"text\":\"%{b5f76dbe-2a2e-4625-ab2a-66c5d1c71765}\"},{\"Name\":\"OperationType\",\"text\":\"Object Access\"},{\"Name\":\"HandleId\",\"text\":\"0x0\"},{\"Name\":\"AccessList\",\"text\":\"%%7688\"},{\"Name\":\"AccessMask\",\"text\":\"0x100\"},{\"Name\":\"Properties\",\"text\":\"%%7688 {89e95b76-444d-4c62-991a-0facbeda640c} {19195a5b-6da0-11d0-afd3-00c04fd930c9}\"},{\"Name\":\"AdditionalInfo\",\"text\":\"-\"},{\"Name\":\"AdditionalInfo2\"}]}}}", "category.generic": "Directory Service Object", "category.high": "System Management", "category.low": "Manipulation", "datafield2": "%%7688 {89e95b76-444d-4c62-991a-0facbeda640c} {19195a5b-6da0-11d0-afd3-00c04fd930c9}", "datafield5": "0x100", "event_src.category": "Operating system", "event_src.fqdn": "ecsb003006a9.dc.atomic.local", "event_src.host": "ecsb003006a9.dc.atomic.local", "event_src.hostname": "ecsb003006a9", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_4662_An_operation_was_performed_on_an_object", "importance": "medium", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "4662", "normalized": true, "object": "ds_object", "object.name": "b5f76dbe-2a2e-4625-ab2a-66c5d1c71765", "object.type": "19195a5b-6da0-11d0-afd3-00c04fd930c9", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-05T20:44:22.248Z", "status": "success", "subject": "account", "subject.account.domain": "dc", "subject.account.id": "S-1-5-18", "subject.account.name": "ecsb003006a9$", "subject.account.session_id": "95787563137", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2023-06-05T19:35:22.922Z", "type": "raw", "uuid": "ac227de2-f782-45d9-b886-7dd62483bc2f"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action": "sync", "category.generic": "Attack", "category.high": "Credential Access", "category.low": "OS Credential Dumping: DCSync", "correlation_name": "DCSync", "correlation_type": "incident", "datafield2": "%%7688 {89e95b76-444d-4c62-991a-0facbeda640c} {19195a5b-6da0-11d0-afd3-00c04fd930c9}", "datafield5": "0x100", "event_src.category": "Operating system", "event_src.host": "ecsb003006a9.dc.atomic.local", "event_src.hostname": "ecsb003006a9", "event_src.subsys": "Security", "event_src.title": "windows", "event_src.vendor": "microsoft", "importance": "high", "incident.aggregation.key": "DCSync|ecsb003006a9.dc.atomic.local|ecsb003006a9$", "incident.aggregation.timeout": 600, "incident.category": "Undefined", "incident.severity": "high", "object": "account", "status": "success", "subject": "account", "subject.account.domain": "dc", "subject.account.id": "S-1-5-18", "subject.account.name": "ecsb003006a9$", "subject.account.session_id": "95787563137"}
