{"action": "start", "body": "{\"Event\":{\"xmlns\":\"http://schemas.microsoft.com/win/2004/08/events/event\",\"System\":{\"Provider\":{\"Name\":\"Microsoft-Windows-Sysmon\",\"Guid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\"},\"EventID\":\"8\",\"Version\":\"2\",\"Level\":\"4\",\"Task\":\"8\",\"Opcode\":\"0\",\"Keywords\":\"0x8000000000000000\",\"TimeCreated\":{\"SystemTime\":\"2019-04-27T18:47:00.0624748Z\"},\"EventRecordID\":\"7023\",\"Correlation\":\"\",\"Execution\":{\"ProcessID\":\"1816\",\"ThreadID\":\"1228\"},\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"Computer\":\"IEWIN7\",\"Security\":{\"UserID\":\"S-1-5-18\"}},\"EventData\":{\"Data\":[{\"Name\":\"RuleName\"},{\"Name\":\"UtcTime\",\"text\":\"2019-04-27 18:47:00.062\"},{\"Name\":\"SourceProcessGuid\",\"text\":\"{365abb72-a3a4-5cc4-0000-001084960c00}\"},{\"Name\":\"SourceProcessId\",\"text\":\"1288\"},{\"Name\":\"SourceImage\",\"text\":\"C:\\\\Users\\\\Public\\\\KeeFarce.exe\"},{\"Name\":\"TargetProcessGuid\",\"text\":\"{365abb72-a201-5cc4-0000-00104f500800}\"},{\"Name\":\"TargetProcessId\",\"text\":\"2364\"},{\"Name\":\"TargetImage\",\"text\":\"C:\\\\Program Files\\\\KeePass Password Safe 2\\\\KeePass.exe\"},{\"Name\":\"NewThreadId\",\"text\":\"1920\"},{\"Name\":\"StartAddress\",\"text\":\"0x5A801260\"},{\"Name\":\"StartModule\",\"text\":\"C:\\\\Users\\\\Public\\\\BootstrapDLL.dll\"},{\"Name\":\"StartFunction\",\"text\":\"LoadManagedProject\"}]}}}", "category.generic": "Thread", "category.high": "Availability Management", "category.low": "Control", "datafield6": "0x5A801260", "event_src.category": "Other", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "generator.type": "logcollector", "generator.version": "N26.0.2936", "id": "PT_Microsoft_Windows_eventlog_Sysmon_8_Create_remote_thread", "importance": "low", "input_id": "00000000-0000-0000-0000-000000000000", "mime": "application/x-pt-eventlog", "msgid": "8", "normalized": true, "object": "thread", "object.fullpath": "c:\\users\\public\\bootstrapdll.dll", "object.id": "1920", "object.name": "BootstrapDLL.dll", "object.path": "c:\\users\\public\\bootstrapdll.dll", "object.process.fullpath": "c:\\program files\\keepass password safe 2\\keepass.exe", "object.process.guid": "365abb72-a201-5cc4-0000-00104f500800", "object.process.id": "2364", "object.process.name": "keepass.exe", "object.process.path": "c:\\program files\\keepass password safe 2\\", "object.property": "start function", "object.value": "LoadManagedProject", "recv_ipv4": "127.0.0.1", "recv_time": "2023-06-05T14:33:22.264Z", "status": "success", "subject": "process", "subject.process.fullpath": "c:\\users\\public\\keefarce.exe", "subject.process.guid": "365abb72-a3a4-5cc4-0000-001084960c00", "subject.process.id": "1288", "subject.process.name": "keefarce.exe", "subject.process.path": "c:\\users\\public\\", "tag": "some_tag", "task_id": "00000000-0000-0000-0000-000000000000", "taxonomy_version": "26.0.215-release-26.0", "time": "2019-04-27T18:47:00.062Z", "type": "raw", "uuid": "87e5e3bb-0cd2-4859-b54c-a79d89e3d3d3"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action": "start", "alert.context": "BootstrapDLL.dll", "alert.key": "c:\\users\\public\\keefarce.exe|c:\\program files\\keepass password safe 2\\|iewin7", "category.generic": "Attack", "category.high": "Credential Access", "category.low": "Credentials from Password Stores: Password Managers", "correlation_name": "KeePass_CredDump", "correlation_type": "incident", "datafield6": "0x5A801260", "event_src.category": "Other", "event_src.fqdn": "iewin7", "event_src.host": "iewin7", "event_src.hostname": "iewin7", "event_src.subsys": "Microsoft-Windows-Sysmon/Operational", "event_src.title": "sysmon", "event_src.vendor": "microsoft", "importance": "medium", "incident.aggregation.key": "KeePass_CredDump|iewin7|keefarce.exe", "incident.aggregation.timeout": 7200, "incident.category": "Undefined", "incident.severity": "medium", "object": "thread", "object.process.fullpath": "c:\\program files\\keepass password safe 2\\keepass.exe", "object.process.guid": "365abb72-a201-5cc4-0000-00104f500800", "object.process.id": "2364", "object.process.name": "keepass.exe", "object.process.path": "c:\\program files\\keepass password safe 2\\", "object.property": "start function", "object.value": "LoadManagedProject", "status": "success", "subject": "process", "subject.process.fullpath": "c:\\users\\public\\keefarce.exe", "subject.process.guid": "365abb72-a3a4-5cc4-0000-001084960c00", "subject.process.id": "1288", "subject.process.name": "keefarce.exe", "subject.process.path": "c:\\users\\public\\"}
