# Здесь укажи какие нормализованные события (одно или несколько) ты подаешь на вход правилу корреляции.
# События отделяются друг от друга символом новой строки. Каждое их них должно быть записано в строку.
{"action":"call","datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.id":"6ad52b32-d609-4be9-ae07-ce8dae937e39","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"Microsoft_Windows_eventlog_Common_RPC_6_Server_RPC_call_started","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"6","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"30","object.type":"rpc","protocol":"TCP","protocol.layer7":"RPC","recv_ipv4":"127.0.0.1","recv_time":"2024-06-24T14:45:28.993Z","status":"success","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2020-09-18T14:02:46.663Z","type":"raw","uuid":"2daf1a20-55cf-41de-8b7d-758319298edc"}
{"action":"call","datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.id":"6ad52b32-d609-4be9-ae07-ce8dae937e39","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"Microsoft_Windows_eventlog_Common_RPC_6_Server_RPC_call_started","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"6","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"15","object.type":"rpc","protocol":"TCP","protocol.layer7":"RPC","recv_ipv4":"127.0.0.1","recv_time":"2024-06-24T14:45:28.993Z","status":"success","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2020-09-18T14:02:46.657Z","type":"raw","uuid":"94ec5583-7b29-446a-a03e-b54085d4e968"}
{"action":"call","datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.id":"6ad52b32-d609-4be9-ae07-ce8dae937e39","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"Microsoft_Windows_eventlog_Common_RPC_6_Server_RPC_call_started","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"6","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"4","object.type":"rpc","protocol":"TCP","protocol.layer7":"RPC","recv_ipv4":"127.0.0.1","recv_time":"2024-06-24T14:45:28.993Z","status":"success","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2020-09-18T14:02:46.657Z","type":"raw","uuid":"86fbff4f-7f80-42fe-be9d-2fd1d22d60fb"}
{"action":"call","datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.id":"6ad52b32-d609-4be9-ae07-ce8dae937e39","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"Microsoft_Windows_eventlog_Common_RPC_6_Server_RPC_call_started","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"6","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"15","object.type":"rpc","protocol":"TCP","protocol.layer7":"RPC","recv_ipv4":"127.0.0.1","recv_time":"2024-06-24T14:45:28.993Z","status":"success","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2020-09-18T14:02:46.655Z","type":"raw","uuid":"4972ff67-0c8a-42b8-888c-c12a0af78bd7"}
{"action":"call","datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.id":"6ad52b32-d609-4be9-ae07-ce8dae937e39","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"logcollector","generator.version":"N26.0.2936","id":"Microsoft_Windows_eventlog_Common_RPC_6_Server_RPC_call_started","importance":"info","input_id":"00000000-0000-0000-0000-000000000000","mime":"application/x-pt-eventlog","msgid":"6","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"4","object.type":"rpc","protocol":"TCP","protocol.layer7":"RPC","recv_ipv4":"127.0.0.1","recv_time":"2024-06-24T14:45:28.992Z","status":"success","tag":"some_tag","task_id":"00000000-0000-0000-0000-000000000000","taxonomy_version":"26.0.215-release-26.0","time":"2020-09-18T14:02:46.655Z","type":"raw","uuid":"77a1506c-2427-469e-a61f-24285c004824"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"action":"call","category.generic":"Attack","category.high":"Lateral Movement","category.low":"Exploitation of Remote Services","correlation_name":"CVE_2020_1472_Zerologon_Exploitation","correlation_type":"incident","count":1,"datafield1":"NULL","datafield2":"1","datafield3":"0","datafield4":"0","dst.port":49668,"event_src.category":"Operating system","event_src.fqdn":"laptop-ju4m3i0e","event_src.host":"laptop-ju4m3i0e","event_src.hostname":"laptop-ju4m3i0e","event_src.subsys":"rpc","event_src.title":"windows","event_src.vendor":"microsoft","generator.type":"correlationengine","importance":"high","incident.aggregation.key":"CVE_2020_1472_Zerologon_Exploitation|laptop-ju4m3i0e","incident.aggregation.timeout":7200,"incident.category":"VulnerabilityExploitation","incident.severity":"high","normalized":true,"object":"interface","object.id":"12345678-1234-abcd-ef00-01234567cffb","object.name":"{12345678-1234-abcd-ef00-01234567cffb}","object.query":"30","object.type":"rpc","origin_app_id":"00000000-0000-0000-0000-000000000005","primary_siem_app_id":"00000000-0000-0000-0000-000000000005","status":"success","time":"2020-09-18T14:02:46.663Z"}