# Здесь укажи какие нормализованные события (одно или несколько) ты подаешь на вход правилу корреляции.
# События отделяются друг от друга символом новой строки. Каждое их них должно быть записано в строку.
{"action": "execute","category.generic": "Process","category.high": "System Management","category.low": "Manipulation","datafield1": "501","datafield10": "TERM_SESSION_ID=w1t0p0:4D797CAE-315D-40B1-992F-3FAF2BB008F1,SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.nxCdRhgPjp/Listeners,LC_TERMINAL_VERSION=3.4.23,COLORFGBG=15;0,ITERM_PROFILE=Default,XPC_FLAGS=0x0,PWD=/Users/user/Desktop,SHELL=/bin/zsh,__CFBundleIdentifier=com.googlecode.iterm2,SECURITYSESSIONID=186a4,LC_CTYPE=UTF-8,TERM_PROGRAM_VERSION=3.4.23,TERM_PROGRAM=iTerm.app,PATH=/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin,LC_TERMINAL=iTerm2,COLORTERM=truecolor,COMMAND_MODE=unix2003,TERM=xterm-256color,HOME=/Users/user,TMPDIR=/var/folders/n1/s1s8jdd919s8djb84sr3myrw0000gn/T/,USER=user,XPC_SERVICE_NAME=0,LOGNAME=user,LaunchInstanceID=AD7D0786-406B-4A8C-9782-5B35118872AC,ITERM_SESSION_ID=w1t0p0:4D797CAE-315D-40B1-992F-3FAF2BB008F1,__CF_USER_TEXT_ENCODING=0x0:0:0,SHLVL=1,OLDPWD=/Users/user,HOMEBREW_PREFIX=/opt/homebrew,HOMEBREW_CELLAR=/opt/homebrew/Cellar,HOMEBREW_REPOSITORY=/opt/homebrew,MANPATH=/opt/homebrew/share/man::,INFOPATH=/opt/homebrew/share/info:,P9K_TTY=old,_P9K_TTY=/dev/ttys001,ZSH=/Users/user/.oh-my-zsh,PAGER=less,LESS=-R,LSCOLORS=Gxfxcxdxbxegedabagacad,LS_COLORS=di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43,P9K_SSH=0,_P9K_SSH_TTY=/dev/ttys001,_=/usr/bin/crontab","datafield12": "1932","datafield13": "2023-07-11T08:56:22.000000000Z","datafield14": "2023-07-11T08:56:22.000000000Z","datafield15": "2023-07-11T08:56:22.000000000Z","datafield16": "true","datafield17": "com.apple.crontab","datafield18": "570492929","datafield2": "20","datafield3": "501","datafield4": "20","datafield5": "true","datafield6": "false","datafield7": "com.apple.zsh","datafield8": "570492929","event_src.category": "Host security","event_src.host": "127.0.0.1","event_src.title": "edr","event_src.vendor": "positive_technologies","generator.type": "logcollector","generator.version": "N26.2.3282","id": "PT_Positive_Technologies_XDR_es_logger_process_execution","importance": "info","input_id": "00000000-0000-0000-0000-000000000000","mime": "application/json","msgid": "9","normalized": true,"object": "process","object.hash": "96BCF70E095EB374148AE3BC8B2BE4F0AD2DD490","object.process.cmdline": "crontab /tmp/some-job","object.process.cwd": "/Users/user/Desktop","object.process.fullpath": "/usr/bin/crontab","object.process.id": "1932","object.process.name": "crontab","object.process.parent.id": "855","object.process.path": "/usr/bin/","recv_ipv4": "127.0.0.1","recv_time": "2024-07-08T17:41:36.705Z","status": "success","subject": "process","subject.account.id": "501","subject.account.session_id": "854","subject.process.fullpath": "/bin/zsh","subject.process.hash": "UNKNOWN:6141DE079756F94ACFA074801FC834C366FA2904","subject.process.id": "1932","subject.process.name": "zsh","subject.process.parent.id": "855","subject.process.path": "/bin/","tag": "some_tag","task_id": "00000000-0000-0000-0000-000000000000","taxonomy_version": "26.0.220-release-26.0","time": "2024-03-19T09:24:34.530Z","type": "raw","uuid": "c4e6dc1b-915c-4a45-8c93-ff5aa589493c"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"correlation_name":"MacOS_Schedule_CronJob_from_Tmp_Dir"}