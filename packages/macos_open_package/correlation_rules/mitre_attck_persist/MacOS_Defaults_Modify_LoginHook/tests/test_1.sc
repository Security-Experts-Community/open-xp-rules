# Здесь укажи какие нормализованные события (одно или несколько) ты подаешь на вход правилу корреляции.
# События отделяются друг от друга символом новой строки. Каждое их них должно быть записано в строку.
{"action": "execute","category.generic": "Process","category.high": "System Management","category.low": "Manipulation","datafield1": "501","datafield10": "MANPATH=/opt/homebrew/share/man::,TERM_PROGRAM=iTerm.app,_P9K_TTY=/dev/ttys000,TERM=xterm-256color,SHELL=/bin/zsh,HOMEBREW_REPOSITORY=/opt/homebrew,TMPDIR=/var/folders/n1/s1s8jdd919s8djb84sr3myrw0000gn/T/,TERM_PROGRAM_VERSION=3.4.23,TERM_SESSION_ID=w0t0p0:60D5DFFA-2E6E-4E50-9A6F-6DB91F73DC82,ZSH=/Users/user/.oh-my-zsh,USER=user,LS_COLORS=di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43,COMMAND_MODE=unix2003,SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.nxCdRhgPjp/Listeners,__CF_USER_TEXT_ENCODING=0x0:0:0,PAGER=less,LSCOLORS=Gxfxcxdxbxegedabagacad,PATH=/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin,_=/usr/bin/defaults,LaunchInstanceID=AD7D0786-406B-4A8C-9782-5B35118872AC,__CFBundleIdentifier=com.googlecode.iterm2,PWD=/Users/user/Desktop,P9K_SSH=0,P9K_TTY=old,ITERM_PROFILE=Default,XPC_FLAGS=0x0,XPC_SERVICE_NAME=0,SHLVL=2,HOME=/Users/user,COLORFGBG=15;0,LC_TERMINAL_VERSION=3.4.23,HOMEBREW_PREFIX=/opt/homebrew,ITERM_SESSION_ID=w0t0p0:60D5DFFA-2E6E-4E50-9A6F-6DB91F73DC82,LESS=-R,LOGNAME=user,LC_CTYPE=UTF-8,INFOPATH=/opt/homebrew/share/info:,HOMEBREW_CELLAR=/opt/homebrew/Cellar,_P9K_SSH_TTY=/dev/ttys000,LC_TERMINAL=iTerm2,SECURITYSESSIONID=186a4,COLORTERM=truecolor","datafield12": "1232","datafield13": "2023-07-11T08:56:22.000000000Z","datafield14": "2023-07-11T08:56:22.000000000Z","datafield15": "2023-07-11T08:56:22.000000000Z","datafield16": "true","datafield17": "com.apple.defaults","datafield18": "570509825","datafield2": "20","datafield3": "501","datafield4": "20","datafield5": "true","datafield6": "false","datafield7": "com.apple.bash","datafield8": "570492929","event_src.category": "Host security","event_src.host": "127.0.0.1","event_src.title": "edr","event_src.vendor": "positive_technologies","generator.type": "logcollector","generator.version": "N26.2.3282","id": "PT_Positive_Technologies_XDR_es_logger_process_execution","importance": "info","input_id": "00000000-0000-0000-0000-000000000000","mime": "application/json","msgid": "9","normalized": true,"object": "process","object.hash": "EC4120B645FAFAEBECD8C0185B70FDB7252335C2","object.process.cmdline": "defaults -currentHost write com.apple.loginwindow LoginHook /Users/user/Desktop/test.sh","object.process.cwd": "/Users/user/Desktop","object.process.fullpath": "/usr/bin/defaults","object.process.id": "1233","object.process.name": "defaults","object.process.parent.id": "1232","object.process.path": "/usr/bin/","recv_ipv4": "127.0.0.1","recv_time": "2024-06-18T15:37:06.598Z","status": "success","subject": "process","subject.account.id": "501","subject.account.session_id": "470","subject.process.fullpath": "/bin/bash","subject.process.hash": "UNKNOWN:A40DBBD3AAEEA208D82E383E279A6B2B0D69907A","subject.process.id": "1233","subject.process.name": "bash","subject.process.parent.id": "1232","subject.process.path": "/bin/","tag": "some_tag","task_id": "00000000-0000-0000-0000-000000000000","taxonomy_version": "26.0.220-release-26.0","time": "2024-03-19T08:32:26.971Z","type": "raw","uuid": "12e58063-6426-479e-a752-7ab7c43fcb2c"}

# Тут будет твой тест. В секции expect укажи сколько и каких корреляционных событий ты ожидаешь
expect 1 {"_rule":"MacOS_Defaults_Modify_LoginHook","datafield17":"com.apple.defaults","datafield19":"LoginHook","datafield20":"/Users/user/Desktop/test.sh"}