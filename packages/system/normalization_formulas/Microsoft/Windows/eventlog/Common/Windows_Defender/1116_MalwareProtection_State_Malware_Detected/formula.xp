EVENTLOG = 'EventID="1116"'
COND = lower($Channel)=="microsoft-windows-windows defender/operational" and $Provider["Name"]=="Microsoft-Windows-Windows Defender"

msgid = $EventID

action = "alert"
object = "malware"
status = "success"

object.id = $Data["Threat ID"]
object.name = $Data["Threat Name"]
object.path = $Data["Path"]
object.account.name = $Data["Detection User"]
object.type = $Data["Category Name"]

datafield1 = $Data["Security intelligence Version"]
datafield2 = $Data["Engine Version"]

importance = "info"

event_src.vendor = "microsoft"
event_src.title = "windows"
event_src.subsys = $Channel

if find_substr($Computer, '.') != null then
    event_src.fqdn = lower($Computer)
    event_src.hostname = lower(substr($Computer, 0, find_substr($Computer, '.')))
else
    event_src.hostname = lower($Computer)
endif

event_src.category = "Anti-virus"
time = $Data["Detection Time"]


id = "1116_MalwareProtection_State_Malware_Detected"